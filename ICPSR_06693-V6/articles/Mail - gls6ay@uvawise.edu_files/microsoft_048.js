window.scriptsLoaded = window.scriptsLoaded || {}; window.scriptProcessStart = window.scriptProcessStart || {}; window.scriptProcessStart['microsoft.owa.attachments.collabattachmentpreview.js'] = (new Date()).getTime();
Type.registerNamespace("_ad");function CollabAttachmentPreviewComponent(){}CollabAttachmentPreviewComponent.$$cctor=function(){_a.t.a().a(CollabAttachmentPreviewComponent)};CollabAttachmentPreviewComponent.prototype={b:function(n,t,i){var r=this;n.b(_at.R,function(){var r=_at.w.b(i);var t=n.a(_y.a);return new _ad.K(t,n.a(_j.o),n.a(_g.a),r?null:n.a(_y.cy),r?n.a(_y.bP):null,n.d(_y.Y),n.d(_y.u),n.c(_db.bl),n.a(_bc.b),n.d(_y.gm),n.d(_y.iq),n.a(_y.gf),n.f(_y.gw),n.f(_y.eZ),n.a(_j.j),n.a(_a.x),n.a(_a.f),i,n.a(_a.r),n.c(_y.bA),n.c(_y.fT),n.a(_h.o),_at.l.a(),n.a(_y.q),n.a(_a.T),n.a(_ad.G),n.a(_ad.H),n.a(_ad.F),n.a(_at.L),t.b()?n.a(_y.br):t.c(),i.a()==="TouchNarrow"?n.a(_y.r):null)});var u=this;n.b(_y.gh,function(){return new _ad.U(n.a(_at.R))});var f=this;n.b(_ad.G,function(){return new _ad.G(n.a(_h.o),n.a(_a.f),n.a(_at.L),n.a(_g.a),n.c(_y.fT))});var e=this;n.b(_ad.H,function(){return new _ad.H(n.c(_db.A),n.c(_y.ee))});var o=this;n.b(_ad.F,function(){return new _ad.F(n.c(_db.bg),n.c(_db.o),n.a(_h.o))});var s=this;n.b(_ad.D,function(){return new _ad.D(n.a(_a.T))}).a()},a:function(){return[new _j.y(_ad.D,0,-1)]}};_ad.D=function(n){var t=new _y.iK;n.e("/attachmentlightbox",t.c)};_ad.Q=function(n,t){_ad.Q.initializeBase(this);this.f=n;this.e=t};_ad.Q.prototype={f:null,e:null,K:function(n){var t=new _gg.gU;t.AttachmentId=this.f;var i=new _gg.rn(this.L);_j.h.a(this.e)||(i.explicitLogonUser=this.e);n.bK(t,i,this.J,this.H)},cS:function(n,t,i){if(n.Status){_j.e.b(_a.a.c,"GetAttachmentTextPreview returned {0}",n.Status);i(Error.create("GetAttachmentTextPreview returned "+n.Status))}else t()}};_ad.E=function(n,t){_ad.E.initializeBase(this);this.e=n;this.f=t};_ad.E.prototype={e:null,f:null,K:function(n){var i=new _gg.tT(this.L);i.actionName=_ad.E.a;var t;var r=(t=new _gg.hI,t.FileId=this.e,t.FileUrl=this.f,t);n.gh(r,i,this.J,this.H)},cS:function(n,t,i){try{t()}catch(r){i(r)}}};_ad.bf=function(){};_ad.bf.registerInterface("_ad.bf");_ad.N=function(){};_ad.N.registerInterface("_ad.N");_ad.M=function(){};_ad.M.registerInterface("_ad.M");_ad.L=function(){};_ad.L.registerInterface("_ad.L");_ad.p=function(){};_ad.p.registerInterface("_ad.p");_ad.O=function(){};_ad.O.registerInterface("_ad.O");_ad.P=function(n){_ad.P.initializeBase(this);this.f=n};_ad.P.prototype={f:null,e:0,K:function(n){var t=new _gg.kE;t.AttachmentId=this.f;n.dk(t,new _gg.CH(this.L),this.J,this.H)},cS:function(n,t,i){this.e=n.Result;if(this.e){_j.e.b(_a.a.c,"SynchronizeWacAttachment returned {0}",this.e);i(Error.create("SynchronizeWacAttachment returned "+this.e))}else t()}};_ad.be=function(){this.g=Function.createDelegate(this,this.o)};_ad.be.prototype={h:null,k:null,c:function(){return this.k},j:null,n:null,o:function(){this.j()}};_ad.R=function(n,t,i,r,u,f){_ad.R.initializeBase(this);this.h=n;this.j=t;this.i=i;this.m=r;this.l=u;this.n=f};_ad.R.prototype={i:null,m:null,l:null,a:function(n){_mcp.d.isInstanceOfType(n)?n.bi().b(null,null):this.i.b().bi().b(null,null)},d:function(n){this.k=n.be().d();n.be().c(this.h);n.bo().d(this.g)},b:function(n){n.be().c(n.be().d());n.bo().g(this.g)},e:function(n,t){this.p(t)},f:function(n,t){this.q(t)},p:function(n){var t=this.i.b();t.bE=!0;var i=t.Y;i.f(!1);this.i.f(t,!1);var r=this;this.l.a(function(t){var r=t.a(i,null,null);n.c(r)})},q:function(n){var t=n.a();t.bE=!0;var i=t.Y;i.f(!1);t.bk().a(t,!1);this.i.a(i)}};_ad.S=function(n,t,i,r){_ad.S.initializeBase(this);this.h=n;this.j=t;this.i=i;this.n=r};_ad.S.prototype={i:null,a:function(n){_y.i.isInstanceOfType(n)?n.bi().b(null,null):n.bC.b().bi().b(null,null)},d:function(n){this.k=n.be().d();n.be().c(this.h);n.bo().d(this.g)},b:function(n){n.be().c(n.be().d());n.bo().g(this.g)},e:function(n,t){this.l(n,t)},f:function(n,t){this.m(n,t)},l:function(n,t){var i=n.a().b().b();i.bE=!0;var r=i.Y;r.f(!1);n.a().b().f(i,!1);var u=this;this.i.a(function(n){var i=n.a(r,null,null);i.O(!0);t.c(i)})},m:function(n,t){var i=t.a();i.bE=!0;var r=i.Y;r.f(!1);i.bk().a(i,!1);n.a().b().a(r)}};_ad.T=function(n,t,i,r,u,f){_ad.T.initializeBase(this);this.h=n;this.j=t;this.l=r;this.m=u;this.i=f};_ad.T.prototype={l:null,m:null,i:null,a:function(n){_y.i.isInstanceOfType(n)?n.bi().b(null,null):n.bC.b().bi().b(null,null)},d:function(n){var t;t=_y.i.isInstanceOfType(n)?n:n.b().b();this.k=t.be().d();t.be().c(this.h);t.bo().d(this.g);t.be().i(this.i.bM)},b:function(n){var t;t=_y.i.isInstanceOfType(n)?n:n.b().b();t.be().c(t.be().d());t.bo().g(this.g);t.be().r(this.i.bM)},e:function(n,t){_y.i.isInstanceOfType(n.a())?this.q(n,t):this.p(n,t)},f:function(n,t){_y.i.isInstanceOfType(t.a())?this.s(t):this.r(n,t)},q:function(n,t){var i=n.a();i.bE=!0;var r=i.Y;r.f(!1);this.m.f(i,!1);var u=this;this.l.a(function(n){var i=n.a(r,null,null);i.O(!0);t.c(i)})},p:function(n,t){var i=n.a().b().b();i.bE=!0;var r=i.Y;r.f(!1);n.a().b().f(i,!1);var u=this;this.l.a(function(n){var i=n.a(r,null,null);t.c(i)})},s:function(n){var t=n.a();t.bE=!0;var i=t.Y;i.f(!1);t.bk().a(t,!1);this.m.a(i)},r:function(n,t){n.c(t.a())}};_ad.K=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht){this.E=Function.createDelegate(this,this.K);this.b=n;this.C=t;this.D=i;this.l=r;this.m=u;this.w=e;this.x=f;this.v=o;this.J=s;this.k=h;this.y=c;this.h=l;this.f=a;this.d=v;this.n=y;this.o=p;this.p=w;this.F=b;this.B=k;this.t=d;this.G=g;this.s=nt;this.i=tt;this.H=it;this.z=rt;this.r=ut;this.u=ft;this.q=et;this.A=ot;this.j=st;this.g=ht;w&&(this.I=w.a().ew().Enabled)};_ad.K.prototype={b:null,C:null,D:null,l:null,m:null,x:null,w:null,v:null,J:null,o:null,p:null,F:null,h:null,k:null,y:null,n:null,B:null,i:null,t:null,G:null,f:null,d:null,s:null,e:null,c:null,H:null,I:!1,z:null,A:null,r:null,u:null,q:null,j:null,g:null,a:function(n,t,i,r,u,f,e,o,s,h){var c=null;f||(c=_ad.c.e(n,o));if(!c){var l=this.b;c=new _ad.c(n,t||l.v||(l.v=Function.createDelegate(l,l.d)),this.n,this.o,this.p,this.B,this.i,this.D,i||this.j,this.z,this.A,this.b,this.C,this.r,this.u,this.q,new _ad.Z,this.k,this.y,this.x,this.w,this.v,this.t,this.g,this.l,this.m,this.s,this.E,this.L(this.b,n,s,e),r,u,f,e,o,h)}return c},L:function(n,t,i,r){switch(n.a()){case"TouchNarrow":return new _ad.X(t,i);case"TouchWide":return new _ad.Y(t,i);case"Mouse":return new _ad.I(t,i,r||!!t||!n.b());default:throw Error.notImplemented("Unexpected value of CurrentLayout: "+n.a());}},K:function(n){var t=null;switch(n){case 0:t=this.h.a();break;case 1:this.e||this.f.f||(this.e=this.f.e());t=this.e.b();break;case 2:this.c||this.d.f||(this.c=this.d.e());t=this.c.a();break;default:Error.invalidOperation("Unsupported reading pane: "+n);break}t.bZ("Unread");return t}};_ad.U=function(n){this.c=n};_ad.U.prototype={c:null,b:function(n,t,i){if("AttachmentId"in n&&"ItemId"in n){var s=n.AttachmentId;var h=n.ItemId;return this.d(s,h)}else if("InternetMessageId"in n&&"AttachmentIndex"in n){var c=n.InternetMessageId;var l=n.AttachmentIndex;return this.e(c,l)}else if(window.opener){var r=new _ad.g;r.eY(JsonParser.deserialize(window.opener.getAttachmentLightBoxContext()));var u=this.c.a(t,null,i,r.l(),!1,!1,!0,null,!0,null);if(_ad.j.isInstanceOfType(r.i())){var f=r.i();u.b(f.d(),null,f.c(),!1,!1,null)}if(_ad.f.isInstanceOfType(r.c())){var a=r.c();u.g(a)}else if(_ad.n.isInstanceOfType(r.c())){var v=r.c();u.el(v.b())}else if(_ad.l.isInstanceOfType(r.c())){var e=r.c();u.h(e.b(),e.a())}else if(_ad.k.isInstanceOfType(r.c())){var o=r.c();u.f(o.b(),o.a())}r.k()&&u.c(!0);return u}else throw Error.argument(String.format("Could not instantiate AttachmentViewModelFactory. Parameters don't include key {0} or some or all of the parameters for Delve (AttachmentId, AttachmentName,ItemId). The parameters received were: {1} AttachmentJson",n.toString()));},e:function(n,t){if(_j.h.a(n)){_j.e.a(_a.a.c,"RestoreDocumentsFromParameters method received null internetMessageId.");return null}if(_j.h.a(t)){_j.e.a(_a.a.c,"RestoreDocumentsFromParameters method received null attachmentIndex.");return null}var i=this.c.a(null,null,null,null,!1,!1,!0,null,!0,null);i.fN(n,Number.parseInvariant(t));return i},d:function(n,t){if(_j.h.a(n)){_j.e.a(_a.a.c,"RestoreDocumentsFromParameters method received null attachmentId from Delve");return null}if(_j.h.a(t)){_j.e.a(_a.a.c,"RestoreDocumentsFromParameters method received null itemId from Delve");return null}var i=this.c.a(null,null,null,null,!1,!1,!0,null,!0,null);i.el(n);i.b(0,null,new _g.e(t),!1,!1,null);return i},a:function(n,t,i){throw Error.notImplemented();}};_ad.w=function(n,t,i,r,u,f,e){_ad.w.initializeBase(this);this.u(i.g);this.p=t;this.g=i;this.q=r;this.l=u;this.c=f;this.o=e;this.d=n.k();this.m=n.l();this.b=n.i();this.a=n.e();this.h=n.j();this.j=n.h();this.i=n.g();this.e=this.a.replace("&isDocumentPreview=True","&isDocumentPreview=False");this.l()};_ad.w.prototype={f:!1,a:null,e:null,h:null,j:null,i:null,p:null,g:null,l:null,q:null,d:!1,m:!1,c:!1,b:!1,o:null,u:function(n){if(this.f!==n){this.f=n;this.eH("HideCloseButton")}return n},t:function(){return this.b?this.a:null},r:function(){return this.n()?"":this.e},n:function(){return!this.d||this.c},s:function(){return!this.d||!this.c}};_ad.F=function(n,t,i){this.b=n;this.a=t;this.c=i};_ad.F.prototype={b:null,a:null,c:null,d:function(n,t,i,r,u,f,e,o){return new _ad.m(n,t,i,this.c,this.a,this.b,r,u,f,e,o)}};_ad.g=function(){_ad.g.initializeBase(this)};_ad.g.prototype={a:null,d:null,c:function(){if(!this.a&&this.b()&&this.f()){this.b()===_ad.n.getName()?this.a=new _ad.n:this.b()===_ad.l.getName()?this.a=new _ad.l:this.b()===_ad.k.getName()?this.a=new _ad.k:this.b()===_ad.e.getName()?this.a=new _ad.e:this.b()===_ad.q.getName()?this.a=new _ad.q:this.b()===_ad.A.getName()?this.a=new _ad.A:this.b()===_ad.C.getName()?this.a=new _ad.C:this.b()===_ad.d.getName()?this.a=new _ad.d:this.b()===_ad.h.getName()?this.a=new _ad.h:this.b()===_ad.z.getName()?this.a=new _ad.z:this.b()===_ad.B.getName()?this.a=new _ad.B:this.b()===_ad.r.getName()&&(this.a=new _ad.r);this.a&&this.a.eY(JsonParser.deserialize(this.f()))}return this.a},e:function(n){if(this.a!==n){this.a=n;this.o(Object.getType(n).getName());this.p(JsonParser.serialize(n.fo()))}return n},i:function(){if(!this.d&&this.g()&&this.h()){this.g()===_ad.j.getName()&&(this.d=new _ad.j);this.d&&this.d.eY(JsonParser.deserialize(this.h()))}return this.d},j:function(n){if(this.d!==n){this.d=n;this.q(Object.getType(n).getName());this.r(JsonParser.serialize(n.fo()))}return n},k:function(){return this.eK(_ad.g.a)},m:function(n){this.eI(_ad.g.a,n);return n},l:function(){return this.eK(_ad.g.b)},n:function(n){this.eI(_ad.g.b,n);return n},b:function(){return this.eK(_ad.g.c)},o:function(n){this.eI(_ad.g.c,n);return n},f:function(){return this.eK(_ad.g.d)},p:function(n){this.eI(_ad.g.d,n);return n},g:function(){return this.eK(_ad.g.e)},q:function(n){this.eI(_ad.g.e,n);return n},h:function(){return this.eK(_ad.g.f)},r:function(n){this.eI(_ad.g.f,n);return n}};_ad.n=function(){_ad.n.initializeBase(this)};_ad.n.prototype={b:function(){return this.eK(_ad.n.a)},a:function(n){this.eI(_ad.n.a,n);return n}};_ad.l=function(){_ad.l.initializeBase(this)};_ad.l.prototype={b:function(){return this.eK(_ad.l.b)},d:function(n){this.eI(_ad.l.b,n);return n},a:function(){return this.eK(_ad.l.a)},c:function(n){this.eI(_ad.l.a,n);return n}};_ad.k=function(){_ad.k.initializeBase(this)};_ad.k.prototype={b:function(){return this.eK(_ad.k.b)},d:function(n){this.eI(_ad.k.b,n);return n},a:function(){return this.eK(_ad.k.a)},c:function(n){this.eI(_ad.k.a,n);return n}};_ad.j=function(){_ad.j.initializeBase(this)};_ad.j.prototype={d:function(){return this.eK(_ad.j.b)},b:function(n){this.eI(_ad.j.b,n);return n},c:function(){return this.eK(_ad.j.a)},a:function(n){this.eI(_ad.j.a,n);return n}};_ad.f=function(){_ad.f.initializeBase(this)};_ad.f.prototype={p:function(n){this.u(n.bz);this.y(n.bl)},y:function(n){this.D(n.bD.AttachmentId);this.z(n.bD.Name);this.E(n.b());this.v(_dg.b.isInstanceOfType(n));this.c()&&this.F(n.bD.ProviderType)},b:function(){return this.eK(_ad.f.b)},z:function(n){this.eI(_ad.f.b,n);return n},f:function(){return this.eK(_ad.f.c)},E:function(n){this.eI(_ad.f.c,n);return n},a:function(){return this.eK(_ad.f.a)},D:function(n){this.eI(_ad.f.a,n);return n},c:function(){return this.eK(_ad.f.f)},v:function(n){this.eI(_ad.f.f,n);return n},o:function(){return this.eK(_ad.f.g)},F:function(n){this.eI(_ad.f.g,n);return n},d:function(){return this.eK(_ad.f.d)},u:function(n){this.eI(_ad.f.d,n);return n},n:function(){return this.eK(_ad.f.e)},q:function(n){this.eI(_ad.f.e,n);return n}};_ad.e=function(){_ad.e.initializeBase(this)};_ad.e.h=function(n){var t=new _ad.e;t.p(n);return t};_ad.e.g=function(n){var t=new _ad.e;t.w(n.ImageUrl);n.PhotoPageUrl?t.t(t.u(n.PhotoPageUrl+"&isDownload=true")):t.t(t.u(n.ImageUrl));t.x(n.ThumbnailUrl||n.ImageUrl);return t};_ad.e.i=function(n,t){var i=_ad.e.g(n[t]);i.B(n);i.q(!1);return i};_ad.e.prototype={p:function(n){_ad.f.prototype.p.call(this,n);this.w(n.fN());this.A(n.hU());this.t(n.V());this.x(n.cE());this.r=n.bm;this.C(!n.eo&&!this.c());if(!this.c()&&n.br()===2&&_dg.d.isInstanceOfType(n.bl)){var t=n.bl;var i="data:"+t.bD.ThumbnailMimeType+";base64,"+t.bD.Thumbnail;this.s=new _at.C(i,t.y(),t.z(),t.t(),!1)}},g:function(){return this.eK(_ad.e.c)},x:function(n){this.eI(_ad.e.c,n);return n},i:function(){return this.eK(_ad.e.a)},t:function(n){this.eI(_ad.e.a,n);return n},e:function(){return this.eK(_ad.e.b)},w:function(n){this.eI(_ad.e.b,n);return n},j:function(){return this.eK(_ad.e.d)},A:function(n){this.eI(_ad.e.d,n);return n},k:function(){return this.eK(_ad.e.e)},B:function(n){this.eI(_ad.e.e,n);return n},l:function(){return this.eK(_ad.e.f)},C:function(n){this.eI(_ad.e.f,n);return n},r:null,h:function(){return this.r},s:null,m:function(){return this.s}};_ad.q=function(){_ad.q.initializeBase(this)};_ad.q.b=function(n){var t=new _ad.q;t.p(n);return t};_ad.q.prototype={p:function(n){_ad.f.prototype.p.call(this,n);this.g(n.fP())},e:function(){return this.eK(_ad.q.a)},g:function(n){this.eI(_ad.q.a,n);return n}};_ad.A=function(){_ad.A.initializeBase(this)};_ad.A.a=function(n){var t=new _ad.A;t.p(n);return t};_ad.C=function(){_ad.C.initializeBase(this)};_ad.C.a=function(n){var t=new _ad.C;t.p(n);return t};_ad.C.prototype={i:null,g:function(){return this.i},h:null,e:function(){return this.h}};_ad.d=function(){_ad.d.initializeBase(this)};_ad.d.h=function(n){var t=new _ad.d;t.p(n);t.x(n.jK());return t};_ad.d.i=function(n){var t=new _ad.d;t.s(n);t.v(!0);t.q(!0);t.m(!1);t.r(!0);t.w(n);t.t(_nbs.a.Uo);return t};_ad.d.prototype={p:function(n){_ad.f.prototype.p.call(this,n);this.A(n.bl.bD.ContentType);this.s(n.bz);if(n.b()){this.w(n.bn()?n.bG:n.bz);this.t(n.b().v(this.j()));this.m(n.b().n());this.r(n.b().o())}else{this.m(!0);this.r(!1)}},j:function(){return this.eK(_ad.d.e)},A:function(n){this.eI(_ad.d.e,n);return n},e:function(){return this.eK(_ad.d.a)},s:function(n){this.eI(_ad.d.a,n);return n},i:function(){return this.eK(_ad.d.d)},x:function(n){this.eI(_ad.d.d,n);return n},h:function(){return this.eK(_ad.d.c)},w:function(n){this.eI(_ad.d.c,n);return n},g:function(){return this.eK(_ad.d.b)},t:function(n){this.eI(_ad.d.b,n);return n},k:function(){return this.eK(_ad.d.f)},m:function(n){this.eI(_ad.d.f,n);return n},l:function(){return this.eK(_ad.d.g)},r:function(n){this.eI(_ad.d.g,n);return n}};_ad.z=function(){_ad.z.initializeBase(this)};_ad.z.a=function(n){var t=new _ad.z;t.p(n);return t};_ad.h=function(){_ad.h.initializeBase(this)};_ad.h.e=function(n,t,i){var r=new _ad.h;r.p(n);r.k(t.d);r.l(i);return r};_ad.h.f=function(n){var t=new _ad.h;t.m(n);t.v(!0);t.q(!0);t.k(!1);return t};_ad.h.prototype={p:function(n){_ad.f.prototype.p.call(this,n)},i:function(){return this.eK(_ad.h.c)},m:function(n){this.eI(_ad.h.c,n);return n},h:function(){return this.eK(_ad.h.b)},k:function(n){this.eI(_ad.h.b,n);return n},e:function(){return this.eK(_ad.h.d)},g:function(){return this.eK(_ad.h.a)},l:function(n){this.eI(_ad.h.a,n);return n},j:function(){switch(_a.bd.a(this.b()||"").toLowerCase()){case".ppt":case".pptx":case".pptm":return!0;default:return!1}}};_ad.B=function(){_ad.B.initializeBase(this)};_ad.B.a=function(n){var t=new _ad.B;t.p(n);return t};_ad.r=function(){_ad.r.initializeBase(this)};_ad.r.b=function(n){var t=new _ad.r;t.p(n);return t};_ad.r.prototype={e:function(){return this.eK(_ad.r.a)},g:function(n){this.eI(_ad.r.a,n);return n},p:function(n){_ad.f.prototype.p.call(this,n);this.g(n.bz)}};_ad.s=function(n,t,i,r,u,f,e,o,s,h,c,l){this.o=Function.createDelegate(this,this.u);this.p=Function.createDelegate(this,this.v);this.n=Function.createDelegate(this,this.r);this.q=Function.createDelegate(this,this.s);_ad.s.initializeBase(this);this.l=e;this.h=t;this.f=s;this.j=i;this.m=u;this.g=_g.e.b(n);this.i=f.d();this.c=o;this.e=h;this.d=c;this.w(new _y.y);if(n.startsWith("smime-")){_j.e.a(_a.a.k,"[ItemAttachmentPreviewViewModel] Creating Smime command factory.");var v=this;r.a(function(t){_j.e.a(_a.a.k,"[ItemAttachmentPreviewViewModel] Creating ItemAttachmentPreviewViewModelCommand instance.");var i=t.a();i.a(v.q,v.n,null);i.b(n)})}else{var a=new _at.G(n,t,l);a.b(this.p);a.c(this.o);_a.g.a.a(a)}};_ad.s.prototype={c:!1,f:null,b:null,j:null,h:!1,l:null,m:null,g:null,i:null,a:null,e:null,d:null,x:function(n){if(this.b!==n){this.b=n;this.eH("ItemReadingPaneViewModel")}return n},t:function(){return this.c?"":this.i},w:function(n){if(this.a!==n){this.a=n;this.eH("ItemConductor")}return n},v:function(n){var t=n.e;t.gw(!0);t.ca(this.g);_j.e.a(_ad.s.a,"GetItemAttachment succeeded for {0}",t.bQ());this.r(t)},u:function(n){_j.e.b(_ad.s.a,"Open ItemAttachment failed with Error: {0}",n.G?n.G.message:"No further details");this.s();this.d&&this.d(n.O())},r:function(n){if(!this.eZ){var t=this;this.j.a(function(i){if(!t.eZ){t.x(i.a(n,t.h,!0,!1,null,null,!1,null,!1,t.m,"All",!1,null,null,null,!0));t.a.e(t.b);t.e&&t.e()}})}},s:function(){this.f&&this.f(0,_u.n.DM,null)},eJ:function(){var n;_a.h.a(n={val:this.a});this.a=n.val;var t;_a.h.a(t={val:this.b});this.b=t.val;_a.gb.prototype.eJ.call(this)}};_ad.H=function(n,t){this.b=n;this.a=t};_ad.H.prototype={b:null,a:null,c:function(n,t,i,r,u,f,e,o,s,h){return new _ad.s(n,t,this.a,this.b,i,r,u,f,e,o,s,h)}};_ad.V=function(n,t){this.e=Function.createDelegate(this,this.c);this.d=Function.createDelegate(this,this.f);this.g=n;var i;this.a=_a.c.b(_a.a.c,"AttachmentLightBoxE2E",!1,(i=new _a.L,i.a=!0,i));this.a.m=this.g(null);this.a.r=new _a.bu(4,2,!0);t&&this.b(t)};_ad.V.prototype={a:null,g:null,b:function(n){this.a&&this.a.q(new _a.B(n))},f:function(n){if(this.a){this.a.m=this.g(n);_a.c.a(this.a);this.a=null}},c:function(n,t){if(this.a){if(_a.K.a()-this.a.s.k<=3e3&&n==="PreviewChangedBeforeLoadingFinished"){this.f();return}this.a.n=n;this.a.p=t;this.a.m=this.g(null);_a.c.a(this.a);this.a=null}},h:function(){if(this.a){if(_a.K.c())try{return window.performance.timing.navigationStart+this.a.s.k}catch(n){}}else return(new Date).getTime();return this.a.s.k}};_ad.X=function(n,t){_ad.X.initializeBase(this,[n,t,!1])};_ad.c=function(n,t,i,r,u,f,e,o,s,h,c,l,a,v,y,p,w,b,k,d,g,nt,tt,it,rt,ut,ft,et,ot,st,ht,ct,lt,at,vt){this.dp=Function.createDelegate(this,this.fA);this.dt=Function.createDelegate(this,this.fL);this.dl=Function.createDelegate(this,this.bz);this.dr=Function.createDelegate(this,this.fJ);this.ds=Function.createDelegate(this,this.fK);this.cy=Function.createDelegate(this,this.fs);this.bI=Function.createDelegate(this,this.er);this.bJ=Function.createDelegate(this,this.eX);this.cw=Function.createDelegate(this,this.fd);this.dq=Function.createDelegate(this,this.ef);this.bK=Function.createDelegate(this,this.fg);this.dn=Function.createDelegate(this,this.fv);this.cu=Function.createDelegate(this,this.eo);this.dk=Function.createDelegate(this,this.ey);this.cs=Function.createDelegate(this,this.en);this.bL=Function.createDelegate(this,this.fh);this.bb=Function.createDelegate(this,this.cB);this.bt=Function.createDelegate(this,this.W);this.dy=Function.createDelegate(this,this.bF);this.di=Function.createDelegate(this,this.dF);this.cv=Function.createDelegate(this,this.eP);this.cz=Function.createDelegate(this,this.fM);this.dz=Function.createDelegate(this,this.fO);this.cx=Function.createDelegate(this,this.fl);this.ct=Function.createDelegate(this,this.dD);this.bH=Function.createDelegate(this,this.z);this.dm=Function.createDelegate(this,this.dX);this.dj=Function.createDelegate(this,this.cb);this.bM=Function.createDelegate(this,this.fp);this.r=new _j.q;this.N=new _ad.g;this.cD=-1;_ad.c.initializeBase(this);this.bX(at);n;this.E=n;this.cU=t;this.D=i;this.H=r;this.cJ=u;this.K=f;this.bP=e;this.bG=o;this.bm=s;this.bB=h;this.db=c;this.Q=l;this.dh=a;this.cM=v;this.cR=y;this.cL=p;this.cT=w;this.cH=b;this.cV=k;this.bo=d;this.cj=g;this.cS=nt;this.cN=tt;this.bl=it;this.ce=ft;this.cC=et;this.j=ot;this.B=st;this.N.n(st);this.ba=ht;this.cK=lt;this.cl=vt;this.bA=at;this.eh(this.bA);if(u){this.cg=u.a().ew().Enabled;this.dS=u.a().b().Enabled;this.ch=u.a().bj().Enabled;this.ci=u.a().ku().Enabled;this.cQ=u.a().hB().Enabled}if(!ct){this.U=_ad.c.f(n);_ad.c.b[this.U]=this;n&&(_ad.c.c[this.U]=n)}this.ca=new _j.g(this.dj,_ad.c.a);this.cZ=new _j.g(this.dm,_ad.c.a);this.bj=new _j.g(this.bH,_ad.c.a);this.dA=new _j.g(this.ct,_ad.c.a);this.cW=new _j.g(this.cx,_ad.c.a);this.be=new _j.g(this.dz,_ad.c.a);this.ek=new _j.g(this.cz,_ad.c.a);this.j.J(this.ct,this.cz,this.cx);this.j.q=this.ci;this.bW=ut?ut.a(this.B):rt;this.D.b(_at.N,this.cv);if(this.Q.a()==="TouchWide")this.eA();else if(this.Q.a()==="TouchNarrow"){this.j.z(!0);this.eq()}this.eG()};_ad.c.e=function(n,t){var i=null;if(n)for(var e=Object.keys(_ad.c.c),u=e,o=u.length,r=0;r<o;++r){var f=u[r];if(_ad.c.c[f]===n){i=_ad.c.b[f];break}}else"0"in _ad.c.b&&(i=_ad.c.b["0"]);if(i){i.bX(t);i.eh(t)}return i};_ad.c.f=function(n){return n?(++_ad.c.d).toString():"0"};_ad.c.prototype={U:null,E:null,cU:null,cg:!1,dS:!1,ch:!1,ci:!1,cQ:!1,H:null,cJ:null,bB:null,db:null,K:null,D:null,bm:null,Q:null,dh:null,cM:null,cR:null,cL:null,cT:null,cH:null,bV:null,cV:null,cm:null,bo:null,cj:null,cS:null,cN:null,bl:null,cC:null,B:null,ba:!1,bW:null,bP:null,bG:null,ce:null,cK:!1,O:null,cn:null,ck:!1,J:!1,j:null,A:null,i:null,cX:!1,bi:null,bh:null,u:!1,p:null,ca:null,cZ:null,cW:null,ek:null,cP:!1,bU:null,X:0,C:null,P:null,M:null,R:null,Z:null,L:null,v:null,br:null,S:null,bg:null,da:null,cE:null,cF:0,cO:!1,Y:null,G:null,bf:null,bD:!1,bY:null,bZ:null,bR:null,bE:null,cI:null,cY:null,bn:null,q:0,bS:!1,bv:!1,de:!1,bw:null,cl:null,bA:null,cq:!1,dO:function(){return this.cK||this.j.b||!this.Q.b()||!!this.E||_y.M.isInstanceOfType(this.i)||this.ba||!this.j.a},d:function(){return this.cq},fy:function(n){if(this.u!==n){this.u=n;this.eH("UseNewLightBoxV3")}return n},bp:function(n){if(this.q!==n){this.q=n;this.eR();this.eV("CollabStep","ShowEditButton","ShouldHidePopoutButton")}return n},ea:function(n){if(this.C!==n){this.C=n;this.eH("ImagePreviewViewModel")}return n},ec:function(n){if(this.P!==n){this.P=n;this.eH("MediaPreviewViewModel")}return n},eb:function(n){if(this.M!==n){this.M=n;this.eH("ItemAttachmentPreviewViewModel")}return n},ee:function(n){if(this.R!==n){this.R=n;this.eH("TextPreviewViewModel")}return n},dY:function(n){if(this.Z!==n){this.Z=n;this.eH("DocumentPreviewViewModel")}return n},dZ:function(n){if(this.L!==n){this.L=n;this.eH("IcsPreviewViewModel")}return n},o:null,bd:null,dc:function(n){if(this.v!==n){this.v=n;this.eH("DocumentConductor")}return n},cd:function(){this.br||(this.br=new _y.y);return this.br},dM:function(){return this.j.a?this.cd():this.v},bj:null,dA:null,cc:function(){return this.bD&&this.q!==3&&this.q!==4},bC:function(n){if(this.bD!==n){this.bD=n;this.eH("ShowEditButton")}return n},co:function(n){if(this.bY!==n){this.bY=n;this.eH("EditButtonText")}return n},dd:function(n){if(this.bZ!==n){this.bZ=n;this.eH("EditButtonTitle")}return n},cA:null,be:null,dN:function(){return _at.q.isInstanceOfType(this.p)&&!!this.p.e()},ed:function(n){if(this.de!==n){this.de=n;this.eH("ShouldShowIntroductionPeek")}return n},T:null,V:function(n){if(this.ck!==n){this.ck=n;this.eH("NeedHighContrastLightbox")}return n},eu:function(){return this.J?"":this.bw},fx:function(n){if(this.J!==n){this.J=n;this.eH("IsDownloadDisabled")}return n},bO:null,bk:null,ev:function(){return this.bk?this.bk.Id:null},s:null,bN:null,w:null,z:function(){!this.i||this.i.bF(!1)?this.dF():this.i.Z(this.di)},a:function(n){if(!this.cP)if(n)this.dB();else{n=n||!this.i||!this.U;this.cP=!0;if(!n||this.dO()){this.eN();this.cU(this);var t=this.bc;var i=this;this.bc=function(){t();i.dispose()};_y.d.isInstanceOfType(this.bm.a())&&this.bm.a().g.bF(!0)}else this.dB()}},c:function(n){this.j.d(!1);this.j.E(n);this.j.e(!0);this.j.z(!this.i);this.bC(this.cc()&&(!!this.i||this.dN()));this.C&&this.C.h(!0)},fN:function(n,t){var i=this;this.ez(n,function(n){i.ex(n.bf().a(0).bD.AttachmentId.Id,function(n){var r=new _ad.h;r.y(n.bf().a(t));var u="";var f,e;!_j.h.a(r.b())&&(e=_at.a.o(r.b(),f={val:u}),u=f.val,e)&&r.z(u);r.q(!0);r.k(!1);i.g(r);i.c(!0)})})},b:function(n,t,i,r,u,f){var h=new _ad.j;h.b(n);h.a(i);this.N.j(h);if(this.cX&&!r){if(this.i.b()){this.bO=i.Id;this.em(i)}return}var o=this.bm;var e=null;var a=null;var c=null;this.A=new _ad.W(this.bo,this.cj,this.D,this.Q.a());this.A.a=this;if(this.cg&&o.a())if(_y.d.isInstanceOfType(o.a())&&_y.i.isInstanceOfType(o.a().g.g().a()))e=o.a().g;else if(_y.cm.isInstanceOfType(o.a())){var l=this.bm.a().a();e=l.c();c=l.i()}if(!e&&o.a()&&_y.d.isInstanceOfType(o.a())){var s=o.a();if(s.g&&s.g.c()&&_y.i.isInstanceOfType(s.g.c())){var v=s.g.c();v.j(null,null)}}this.fy(this.cg&&!!e&&_ad.I.isInstanceOfType(this.j));if(!this.u){f=f||this.cC;e=f(n)}this.E&&e.cW(o,this.E);e.ca(this.ba);e.bR=!0;e.cU(u);if(!_j.h.a(this.B))if(_y.M.isInstanceOfType(e)){var y=_g.y.c(this.B);e.bd(y)}else _rp.n.isInstanceOfType(e)&&(e.cm=this.B);this.i=e;this.bi=a;this.bh=c;this.bO=i.Id;this.eB(t,i)},g:function(n){var t=this.bg;!this.N.c()&&_ad.f.isInstanceOfType(n)&&this.N.e(n);this.Y=n.a();this.bF(this.Y,!1,null);this.cE=n.b();this.cF=n.f();this.cO=n.c();this.fx(n.n());n.b()&&this.ff&&this.ff.d(n.b());var i=this.C;this.es();this.bu(!1);n.c()&&t.b(this.dN()?"SharePoint":"Cloudy");if(_at.bl.isInstanceOfType(n)){t.b("Image");var r=this.cM.f(n,this.dy,t.d,t.e,this.j,this.J);if(i){r.u(i.o);r.h(i.i)}this.ea(r);this.V(!0)}else if(_ad.N.isInstanceOfType(n)){t.b("Media");this.ec(this.cT.a(n,this.j,t.d,t.e,this.J));this.V(!0)}else if(_ad.M.isInstanceOfType(n)){t.b("ItemAttachment");this.eb(this.cR.c(n.a().Id,this.ba,this.E,n,this.j,this.J,this.bt,t.d,t.e,this.B));this.V(!1)}else if(_at.bm.isInstanceOfType(n)){t.b("Text");this.ee(new _ad.x(n,this.bt,this.j,this.K,t.d,t.e,this.J,this.E,this.B));this.V(!1)}else if(_at.bj.isInstanceOfType(n)){t.b("Document");this.dY(new _ad.w(n,this.bt,this.j,this.K,t.d,this.J,this.E));this.V(!1)}else if(_ad.L.isInstanceOfType(n)){t.b("Ics");this.dZ(this.cL.d(n,this.bt,this.bW,this.j,this.B,this.J,t.d,t.e));this.V(!1)}else if(_at.q.isInstanceOfType(n)){t.b("Wac");this.bC(this.bP.c()>0);this.bw=n.d();this.eH("DocumentDownloadUrl");n.g()&&this.bp(4);this.V(n.j());this.dH(n,t)}else if(_ad.p.isInstanceOfType(n)){t.b("SuiteExtension");this.bC(!0);this.bw=n.d();this.eH("DocumentDownloadUrl");this.V(!1);this.dH(n,t)}else if(_ad.O.isInstanceOfType(n)){t.b("PdfJs");this.bC(!1);this.bw=n.d();this.eH("DocumentDownloadUrl");this.V(!1);this.ep(n,t)}},e:function(n,t){if(!n||!n.bl||!n.bl.bD.AttachmentId){_j.e.b(_ad.c.a,"Preview failed, Attachment is null.");return}var i=null;var r=this.bP.a(_a.bd.a(n.bl.bD.Name),n.bl.bD.ContentType,!0,!1,_dg.b.isInstanceOfType(n.bl),!!this.H&&this.H.a().bQ().Enabled,n.dh);switch(n.br()){case 1:case 2:i=_ad.e.h(n);break;case 7:i=_ad.q.b(n);break;case 5:case 9:case 11:i=_ad.A.a(n);break;case 8:i=_ad.C.a(n);break;case 10:i=_ad.d.h(n);break;case 12:i=_ad.r.b(n);break;case 3:i=_ad.h.e(n,r,t);break}i||(n.ep()?i=_ad.z.a(n):n.hT()&&(i=_ad.B.a(n)));if(i){i.q(!r.c());n.bm&&this.r.c(n.bm);this.g(i)}},el:function(n){if(n){var t=new _ad.n;t.a(n);this.N.e(t);this.bf=new _g.bh(n)}},f:function(n,t){var i=new _ad.k;i.d(n);i.c(t);this.N.e(i);var r=_ad.e.i(n,t);this.g(r)},h:function(n,t){var r=new _ad.l;r.d(n);r.c(t);this.N.e(r);var i=null;switch(t){case 0:i=_ad.h.f(n);break;case 1:i=_ad.d.i(n);break}i&&this.g(i)},dR:function(n,t,i){var u=_h.d.a();var r=u.a(n);!r||i?this.dg(n,t,"getting item",!1):t(r)},bz:function(n){var t=new _a.l;t.a("S",this.cF);t.b("T",_a.bd.a(this.cE||""));t.a("R",this.cO?1:0);t.a("W",this.B?1:0);n&&t.b("X",n);return t.toString()},fB:function(n){this.fe(n.eU);for(var i=this.eU.c,u=i.length,t=0;t<u;++t){var r=i[t];if(r.b===_u.P.a){this.eU.q(r,1);break}}var f=new _y.g(_y.b.y(),_y.b.z(),_u.P.a,this.be);this.eU.g(f,1,!0)},dw:function(){_y.lA.prototype.dw.call(this);if(!this.E){this.D.b(_y.Q,this.bb);this.D.b(_y.p,this.bb)}},bx:function(){return 8},x:function(){return null},bc:null,y:function(){return this.bc},m:function(n){this.bc=n;return n},by:function(){return!1},fp:function(){this.o&&this.o.e==="about:blank"&&this.o.G()},eJ:function(){if(!this.eZ){if(this.U){delete _ad.c.b[this.U];this.U!=="0"&&delete _ad.c.c[this.U]}this.D.c(_at.N,this.cv);this.D.c(_y.Q,this.bb);this.D.c(_y.p,this.bb);if(this.ch)for(var n=0;n<this.r.d.length;n++)this.r.d[n].e()||this.r.d[n].bn(this.bL);this.r.f();this.r=null;this.et();this.T&&this.T.c(this.cs);var t;_a.h.a(t={val:this.j});this.j=t.val;var i;_a.h.a(i={val:this.C});this.C=i.val;var r;_a.h.a(r={val:this.P});this.P=r.val;var u;_a.h.a(u={val:this.M});this.M=u.val;var f;_a.h.a(f={val:this.R});this.R=f.val;var e;_a.h.a(e={val:this.L});this.L=e.val;var o;_a.h.a(o={val:this.br});this.br=o.val;var s;_a.h.a(s={val:this.v});this.v=s.val;if(this.o){this.o.dispose();this.o=null}_ad.i.c(this.db);_y.lA.prototype.eJ.call(this)}},ex:function(n,t){var i=new _at.G(n,!1,null);var r=this;i.b(function(n){var i=n.e;_j.e.a(_ad.c.a,"GetItemAttachment succeeded for {0}",i.bQ());t(i)});i.c(this.dk);this.K.a(i)},ez:function(n,t){var r=_h.d.a();var i=r.a(n);i?t(i):this.dg(n,t,"getting item",!0)},ey:function(n){_j.e.b(_ad.c.a,"Open ItemAttachment failed with Error: {0}",n.G?n.G.message:"No further details")},dB:function(){this.N.m(!0);this.fi()},eN:function(){this.cn=this.bB.c();this.bB.b("/attachmentlightbox")},fn:function(){this.D.c(_y.Q,this.bb);this.D.c(_y.p,this.bb);this.cn&&this.bB.b(this.cn)},cB:function(){this.dD()},dD:function(){this.bS=!0;this.u?this.q===3||this.q===4?this.cp("WaitSaveAndCloseByBackButton",this.cu):this.dE():this.q===3||this.q===4?this.cp("WaitSaveAndCloseByBackButton",this.cu):this.z()},dE:function(){if(!this.eZ){var t=this.i.v();var i=this.i.g();var n=t.a();if(_y.i.isInstanceOfType(n)){n.O(!1);var r=this;n.m(function(){})}if(this.s){this.s.a(n);this.s.b(n);this.s.f(i,t)}this.z()}},eo:function(){if(this.o){var n=_a.c.b(_ad.c.a,"AttachmentLightboxCloseByBackButton",!1,null);n.r=new _a.bu(107,2,!0);n.m=this.bz(null);_a.c.a(n);this.o.w();if(this.o.b)this.ej();else{this.v.d();this.z()}}},cb:function(n,t){if(!n){n=this.bX(null);this.bA&&n.b(this.bA);n.b("Edit");this.p.c()&&n.b("Cloudy");_at.q.isInstanceOfType(this.p)?n.b("Wac"):_ad.p.isInstanceOfType(this.p)&&n.b("SuiteExtension")}if(this.eZ){n.c("LightBoxDisposed",null);return}if(this.ei()){this.W(0,_ads.B.c);n.c("EditingNotCurrentlySupported",null);return}if(this.eC()){this.W(0,_ads.B.t);n.c("AttachmentTooLarge",null);return}this.bu(!0);this.ce&&this.r.d.length>0&&this.r.d[0].b()&&this.ce.N(this.r.d[0].b(),_a.bd.a(this.p.b()||""),this.p.c());if(!this.j.a){this.j.d(!0);this.j.e(!0)}if((t||this.w&&this.w.IsInDraft)&&this.p){this.bn=this.p.b();if(this.u){var i=this.i.v().a();i&&this.s.a(i)}else this.A&&this.A.k()}else{this.bn=this.ew(this.p.b());if(this.p.c())this.S=new _ad.t(_ads.B.B,"");else{this.S=new _ad.t(_ads.B.m,this.bn);if(_y.M.isInstanceOfType(this.i)&&this.H.a().t().Enabled){this.ft();this.S=this.G?new _ad.t(_ads.B.b,""):new _ad.t(_ads.B.B,"")}}this.v.e(this.S);this.bp(2)}this.o.M();if(this.q===2){var r=this;_j.m.a().a(_ad.c.a,"AttachmentLightBoxViewModel:EditDocument",function(){if(r.eZ){n.c("LightBoxDisposed",null);return}r.dC(n)},2e3)}else this.dC(n);this.p.c()&&n.f()},dC:function(n){this.cq=!0;if(!this.w||this.w.IsInDraft||this.A.j())this.cG(n);else{for(var t=0;t<this.r.d.length;t++)for(var i=0;i<this.r.d[t].a().x.length;i++){var r=this.r.d[t].a().x[i];r&&r.a().bD.AttachmentId.Id===this.Y.Id&&(this.cD=i)}_y.M.isInstanceOfType(this.i)&&this.G&&this.G.bx===2&&this.H.a().t().Enabled?this.dK(n):this.dI(n)}},dK:function(n){var t=null;var i=this;t=function(r,u){i.dV(n,t)};this.G.apcl("SaveFileToCloudStatus",t);var r=this;this.da=_j.m.a().a(_ad.c.a,"LightBoxViewModel:CreateSaveFileToCloudCompletedOrTimedOutHandler",function(){r.dV(n,t)},this.H.a().t().SaveToCloudTimeout?this.H.a().t().SaveToCloudTimeout:1e4)},dI:function(n){var t=this;this.cj.a(function(i){var r=i.a(!1,!1);r.e(2);r.f(!0);r.cK(!0);var u=new _g.Q;u.Mailbox=new _g.f;u.Mailbox.EmailAddress=t.bG.c().bD.UserEmailAddress;u.Mailbox.Name=t.bG.c().bD.UserDisplayName;u.Mailbox.MailboxType="Mailbox";u.Mailbox.RoutingType="SMTP";r.ep(u);t.bN=r;t.dR(t.bO,function(i){r.T(i);var u;u=t.H.b()||r.h()!=="HTML"?r.h()==="Text"?_h.b.l():_h.b.d():_h.b.L();t.cS.a(function(i){var f=i.d(r,u);f.p(!1);f.D(t.cD);if(_y.M.isInstanceOfType(t.i)){var e=new _mcp.z(f);e.b(function(i){t.fc(i,n)});e.c(function(i){t.fb(i,n)});t.K.a(e)}else{f.b(function(i){t.dU(i,n)});f.c(function(i){t.dT(i,n)});t.K.a(f)}})},!1)})},dT:function(n,t){_j.e.b(_ad.c.a,"Create reply action failed.");var i=null;n.G&&_g.V.a(n.G)&&(i=n.G.FaultMessage);t.c(n.O(),i);var r=this;this.W(0,_nbs.a.dC,function(n,t){r.z()})},fb:function(n,t){var i=n;this.dT(i.e,t)},dU:function(n,t){var i=n;this.bk=i.bg;_j.e.a(_ad.c.a,"New draft item is "+this.bk.Id);if(this.o){this.o.g=this.bk.Id;if(i.bL&&i.bL.length>0)for(var r=0;r<i.bm.bf().b();r++){var u=i.bm.bf().a(r);if(!u.a()){this.o.b=u.bD.AttachmentId.Id;_j.e.a(_ad.c.a,"New attachment id in the draft item is "+this.o.b);break}}this.G&&this.G.bx===2&&!_y.M.isInstanceOfType(this.i)?this.dK(t):this.cG(t)}},fc:function(n,t){var i=n;this.dU(i.e,t)},dV:function(n,t){if(this.eZ){n.c("LightBoxDisposed",null);return}if(this.G){this.G.rpcl("SaveFileToCloudStatus",t);_j.m.a().b(this.da);this.G=null;_y.M.isInstanceOfType(this.i)?this.dI(n):this.cG(n)}},ei:function(){return _at.q.isInstanceOfType(this.p)?!this.p.h()||!this.cQ&&this.eE(this.p.b()):_ad.p.isInstanceOfType(this.p)&&this.o&&this.o.c?!this.o.c.a():!0},eC:function(){return this.p?_at.q.isInstanceOfType(this.p)&&this.p.e()?!1:this.p.f()>=7340032:!1},ew:function(n){return String.format(_ads.B.e,_a.bd.b(n),this.bG.c().bD.UserDisplayName,_a.bd.a(n))},cG:function(n){var t=this;var r=function(i){if(t.eZ){n.c("LightBoxDisposed",null);return}t.w=i;t.q===2&&t.v.d();t.q!==4&&t.bp(3);t.bF(t.Y,!0,i.Name);var r=t.u&&_y.i.isInstanceOfType(t.i.v().a());t.A&&!r&&(t.A.j()?t.o.g&&t.A.n():t.j.a&&t.dX());t.w.IsConversion&&_j.m.a().a(_ad.c.a,"AttachmentLightBoxViewModel:ConvertDocument",function(){t.fF(n)},2e3)};var i=this;this.o.J(r,function(t){if(i.eZ){n.c("LightBoxDisposed",null);return}i.eg(t);n.c(t.f,null)},n.d,n.h())},dX:function(){_y.l.b(_ad.c.a,"ReplyWithChanges",!1,!1);this.j.a||this.o.w();this.A.m()},fF:function(n){if(!this.eZ){var i=this.o.b;_j.e.a(_ad.c.a,"Submitting sync conversion action for attachment {0}.",i);var t=new _ad.P(i);var r=this;t.b(function(t){r.fI(t,n)});var u=this;t.c(function(t){u.fG(t,n)});this.K.a(t)}},fI:function(n,t){_j.e.a(_ad.c.a,"Sync conversion action succeeded.");this.cb(t,!1)},fG:function(n,t){_j.e.b(_ad.c.a,"Sync conversion action failed.");t.c(n.O(),null);var i=this;this.W(0,_nbs.a.TT,function(n,t){i.z()})},fi:function(){this.dW(this.bg)},fl:function(){this.dW(this.bX(null))},dW:function(n){if(!this.eZ){n.b("Popout");window.getAttachmentLightBoxContext=this.dn;this.Q.s(_y.gh,null,{},_bc.d.c());n.f("Popout");this.dL();this.z();this.dispose()}},fv:function(){return JsonParser.serialize(this.N.fo())},fL:function(){this.j.d(!this.j.a);this.bE.g(this.j.a?_ads.B.j:_ads.B.s);this.j.e(!0)},fM:function(){this.bu(!1);if(!this.eZ){var t=this.j.a?"AttachmentLightboxHideReadingPane":"AttachmentLightboxShowReadingPane";var n=_a.c.b(_ad.c.a,t,!1,null);n.r=new _a.bu(108,2,!0);n.r.a(1,t);_a.c.a(n);this.j.e(!0);this.eH("ShouldHidePopoutButton")}},eB:function(n,t){this.cX=!0;this.i.bY(!0);if(this.u){var u=this.i.v();var i=this.i.g();u.o=this.bK;var f,e;if(e=this.eD(i.a(),f={val:this.X}),this.X=f.val,e){this.s=this.dP();if(this.s){this.s.a(i.a());this.s.e(i,u)}}else{u.c(i.a());this.i.bD(!0)}}else{if(!t)return;if(n)this.fz(n,t);else{var r=t.Id;if(_h.d.a().d(r)){_h.d.a().e(r);var o=_h.d.a().a(r);this.ef(o)}else this.dg(r,this.dq,"initializing reading pane",!1)}}},dg:function(n,t,i,r){var u;if(r)u=new _h.bX(100,new Array(0),this.H.b()?_h.b.d():_h.b.l(),"MailCompose",0,this.ba,null,n);else{var f=new _g.e(n);u=new _h.bX(100,[f],this.H.b()?_h.b.d():_h.b.l(),"MailCompose",0,this.ba,null,null)}this.B&&(u.k.explicitLogonUser=this.B);var e=this;u.b(function(r){var u=_h.d.a().a(n);if(u)_j.e.a(_a.a.c,"Successfully retrieved item when {0}.",i);else{u=r.bg();u?_j.e.a(_a.a.c,"Successfully retrieved item with fallback when {0}.",i):_j.e.b(_a.a.c,"Action succeeded but item not cached when {0}.",i)}t(u)});var o=this;u.c(function(n){_j.e.b(_a.a.c,"Unable to retrieve item when {0}.",i)});this.K.a(u)},ef:function(n){this.i.z(n);n&&n.dE(this.cw)},fd:function(n,t){this.z()},fz:function(n,t){this.i.z(n);this.bU=t;this.i.b()&&this.i.b().apcl(this.i.b().d(),this.bJ)},eX:function(n,t){this.i.b().rpcl(this.i.b().d(),this.bJ);this.bU&&this.em(this.bU)},em:function(n){for(var u=!1,t=0;t<this.i.b().c().x.length;t++){var i=this.i.b().c().x[t];if(i.a()&&i.a().bD.ItemId.Id===n.Id){this.i.b().r(i);u=!0;break}}if(!u&&this.i.b().a()&&this.i.b().a().E){var r=!1;if(this.i.b().c().x.length<this.i.b().a().a().b())r=!0;else{var e=this;var f=this.i.b().a().a().s(function(t){return t.Id===n.Id});r=f>=0}if(r){this.i.b().C().a();this.i.b().apcl(this.i.b().d(),this.bJ)}}},fg:function(n){if(this.u&&this.X){this.s||(this.s=this.dP());this.s.d(n)}},eD:function(n,t){t.val=this.dQ(n);return!!t.val},dQ:function(n){if(_y.i.isInstanceOfType(n))return 1;if(_y.it.isInstanceOfType(n)&&n.o()&&n.o().a()&&n.o().a().h()){var t=n.o();var i=t.a().m().a();if(this.cf(i))return 4}if(this.bi&&this.bi.a()&&this.bi.a().h()){var r=this.bi;var u=r.a().m().a();if(this.cf(u))return 3}if(_y.hX.isInstanceOfType(n)&&n.s()&&n.s().c()){var f=n.s().b();var e=f.bb().a();if(this.cf(e))return 5}if(this.bh&&this.bh.b()&&IGroupInlineComposeViewModel.isInstanceOfType(this.bh.b())){var o=this.bh.b();var s=o.bb().a();if(this.cf(s))return 6}return _y.cB.isInstanceOfType(n)&&n.b()?7:0},cf:function(n){if(n.a())for(var t=0;t<n.a().x.length;t++)if(n.a().x[t].bl.bD.AttachmentId.Id===this.Y.Id)return!0;return!1},dP:function(){switch(this.X){case 1:case 2:return new _ad.T(this.be,this.bI,this.cJ,this.bo,this.i,this);case 3:case 6:return new _ad.R(this.be,this.bI,this.bh,this.bi,this.bo,this.bK);case 4:case 5:return new _ad.S(this.be,this.bI,this.bo,this.bK);default:_j.e.c(_a.a.c,"This type of compose is not supported by current implementation: ComposeType = {0} ",this.X);return null}},fO:function(){this.bv=!0;if(this.u&&this.X)if(this.q===3||this.q===4)this.cp("WaitSaveAndSend",this.cy);else{var n=this.i.v().a();var t=this;n.m(function(){t.s.b(n);t.z()});var i=this.dQ(n);this.s.a(n);this.s.c().a()}else this.cp("WaitSaveAndSend",this.cy)},er:function(){if(this.i&&this.i.v()){var n=this.i.v().a();this.s.b(n);this.z()}},cp:function(n,t){this.fE();var i=5e3;_j.m.a().a(_a.a.c,n,t,i)},fs:function(){this.S.d(_ads.B.h);this.o.w();if(this.o.b)this.ej();else{this.v.d();this.z()}},ej:function(){var t=this.o.b;_j.e.a(_ad.c.a,"Submitting sync action for attachment {0}.",t);var n=new _ad.P(t);n.b(this.ds);n.c(this.dr);this.K.a(n)},fK:function(n){_j.e.a(_ad.c.a,"Sync action succeeded.");this.v.d();if(this.bv){this.bv=!1;if(this.u&&this.X){var t=this.i.v().a();t.m(this.bH);this.s.a(t);this.s.c().a()}else{this.cA.a();_y.M.isInstanceOfType(this.i)&&this.z()}}else this.u?this.dE():this.z()},fJ:function(n){_j.e.b(_ad.c.a,"Sync action failed.");this.v.d();this.o.G();if(!n.N){this.W(0,_ads.B.T);return}var t=_ads.B.C;this.bS&&(t=_ads.B.O);this.W(0,t)},fE:function(){this.S=this.p.c()?new _ad.t(_ads.B.o,""):new _ad.t(_ads.B.i,this.bn);this.v.e(this.S)},es:function(){if(this.C){this.C.dispose();this.ea(null)}if(this.P){this.P.dispose();this.ec(null)}if(this.M){this.M.dispose();this.eb(null)}if(this.R){this.R.dispose();this.ee(null)}if(this.L){this.L.dispose();this.dZ(null)}if(this.Z){this.Z.dispose();this.dY(null)}if(this.v){this.v.dispose();this.dc(null)}if(this.o){this.o.dispose();this.o=null}if(this.bd){this.bd.dispose();this.bd=null}},et:function(){if(this.i){this.i.e()&&this.i.e().b()&&this.i.e().b().dC(this.cw);this.i.bD(!1);this.i.bY(!1);if(this.u)this.i=null;else{if(this.i.b()){var n=this.i.b();n.h();n.dv()}else if(this.i.e()){var t=this.i.e();t.h();t.dv()}var i;_a.h.a(i={val:this.i});this.i=i.val}}var r;_a.h.a(r={val:this.A});this.A=r.val},bX:function(n){this.bg&&this.bg.c("PreviewChangedBeforeLoadingFinished",null);return this.bg=new _ad.V(this.dl,n)},eh:function(n){if(this.O){this.O.m="UnexpectedCtqStart";_a.c.a(this.O);this.O=null}this.O=_a.c.b(_a.a.c,"LightboxGlobalCtq",!1,null);this.O.q(new _a.B(n))},dL:function(){if(this.O){_a.c.a(this.O);this.O=null}},bF:function(n,t,i){_j.e.a(_a.a.c,"AttachmentLightBoxViewModel.UpdateSelectedAttachment Id ={0}",n?n.Id:"null");for(var r=0;r<this.r.d.length;r++)this.r.d[r].bt(n,t,i)},ft:function(){for(var n=0;n<this.r.d.length;n++)for(var i=0;i<this.r.d[n].a().x.length;i++){var t=this.r.d[n].a().x[i];if(t.bU&&_j.h.a(t.bl.bD.AttachmentOriginalUrl)){t.iz();this.G=t;return}}},eP:function(n){_j.e.a(_a.a.c,"AttachmentLightBoxViewModel.OnAttachmentWellCreated");if((this.Y||this.bf)&&n.a){var t=this.Y;this.w&&this.w.IsEdit?t=this.w.AttachmentId:this.bf&&(t=this.bf);if(n.a.bt(t,this.j.b,null)&&(!this.j.b||!n.a.e())){_j.e.a(_a.a.c,"AttachmentLightBoxViewModel set AttachmentWellViewModel");this.r.c(n.a);this.ch&&this.j.b&&n.a.by(this.bL);if(this.bf){this.bf=null;for(var r=n.a.a(),i=0;i<r.b();i++){var u=r.c(i);if(u.bv()===t.Id){this.e(u,!1);break}}}}}},eR:function(){_j.e.a(_ad.c.a,"Collab step changed to {0}",this.q);if(this.Q.a()==="Mouse"&&!this.Q.b()&&this.p)switch(this.q){case 1:window.document.title=String.format(_ads.B.a,this.p.b());break;case 2:case 3:window.document.title=String.format(_ads.B.L,this.bn);break;case 4:break;default:break}else if(this.Q.a()==="TouchWide"&&this.bD)switch(this.q){case 1:this.df(this.cI);break;case 2:this.df(null);break;case 3:this.df(this.cY);break;default:break}this.j&&this.j.G(this.q===3||this.q===4)},eA:function(){this.cI=new _y.g(_y.b.bk(),_y.b.bm(),_u.P.F,this.ca);this.cY=new _y.g(_y.b.bT(),_y.b.bU(),_u.n.Ff,this.cZ);var t=new _j.g(this.dt,_ad.c.a);this.bE=new _y.g(_y.b.ci(),_y.b.cj(),this.j.a?_ads.B.j:_ads.B.s,t);this.bR=_y.g.a(_nbs.a.UL,this.bj);var i=[this.bE,this.bR];var n=_y.k.a(this,i,null);n.L(!1);this.fe(n)},eq:function(){if(this.bl){var n=this.bl.b();if(this.dh.a()){n.a(this.bl.a(_y.b.b(),_y.b.b(),this.bj,""));n.e(3)}else n.a(this.bl.a(_y.b.a(),_y.b.a(),this.bj,""));this.fk(n)}},df:function(n){for(var r=this.eU.c,u=r.length,t=0;t<u;++t){var i=r[t];i!==this.bR&&i!==this.bE&&this.eU.q(i,1)}n&&this.eU.g(n,1,!0)},eG:function(){if(_y.Z.b(3)){var n=this;this.cN.a(function(t){n.T=t.a(_ads.B.R,_ads.B.N,8,null,null,3);n.ed(!0);n.T.b(n.cs)})}},en:function(){this.ed(!1)},bu:function(n){this.T&&this.T.a(n)},fC:function(){this.T&&this.T.e()},ep:function(n,t){if(this.cm)this.dJ(n,t);else{var i=this;this.cV.a(function(r){if(r){i.cm=r;i.dJ(n,t)}})}},dJ:function(n,t){if(!this.L&&!this.C&&!this.R&&!this.Z&&!this.P&&!this.M&&!this.o){this.bd=this.cm.a(n.a().Id,n.e(),t.d,t.e,this.E);var i=new _y.y;i.e(this.bd);this.dc(i)}},dH:function(n,t){this.p=n;if(this.bV)this.dG(n,t);else{var i=this;this.cH.a(function(r){if(r){i.bV=r;i.dG(n,t)}})}},dG:function(n,t){if(!this.L&&!this.C&&!this.R&&!this.Z&&!this.P&&!this.M&&!this.bd){var e=n.c();var r=0;var u=null;var f=null;this.bC(this.cc()&&!this.ei());if(_at.q.isInstanceOfType(n)){r=1;u=n.i();f=n.e()}else _ad.p.isInstanceOfType(n)&&(r=2);this.o=this.bV.a(n.a()?n.a().Id:"",n.b(),r,e,this.B,this.ba,this.E,u,f);var o=new _y.y;o.e(this.o);this.dc(o);_at.q.isInstanceOfType(n)&&this.cc()?this.fC():this.bu(!1);if(_at.q.isInstanceOfType(n)&&n.g()){t.b("CreateNew");this.cb(t,!0);return}var i=this;var s=function(t){if(f)i.co(_ads.B.d);else if(u){i.co(_ads.B.r);i.dd(_ads.B.J)}else{i.w=t;if(t)if(n.c()&&n.o()==="OneDriveConsumer"){i.co(_ads.B.g);i.dd(_ads.B.Z)}else{i.co(i.w.IsInDraft?_ads.B.W:_ads.B.r);i.dd(i.w.IsInDraft?_ads.B.k:_ads.B.J)}}i.bp(1)};e&&t.f("NoPostMessageForCloudDoc");var h=this;this.o.K(s,function(n){h.eg(n);t.c(n.f,null)},t.d,t.h())}},W:function(n,t,i){this.D.a(_a.u,new _a.u([t],1,i,n,!1,null,null,null,this.E,null))},eg:function(n){if(this.o===n){var t=this;this.W(0,this.o.r,function(n,i){t.z()})}else _j.e.b(_ad.c.a,"The documentAttachmentViewModel from the failure callback is not the same as the current documentAttachmentViewModel. ShowError() did not display any message.")},fh:function(){if(this.q===4&&this.p.c()&&this.p.a()){var i=this.p.a().Id;var t=new _at.be([i],0,null,!0);this.K.a(t);t.c(this.dp);for(var n=0;n<this.r.d.length;n++)this.r.d[n].e()||this.r.d[n].bn(this.bL)}},fA:function(n){var t=n;var i=t.O();_j.e.c(_a.a.c,"SetPermissionsToOriginal failed. Error: "+i)},dF:function(){this.bg.f("LightBoxClosingBeforeWacLoaded");this.dL();if(!this.eZ){if(this.i){this.i.bD(!1);this.i.bR=!1}this.bF(null,!1,null);this.bu(!1);if(this.A&&!this.u){this.A.k();this.cd().a()&&this.cd().a().O(!1)}if(this.q===3||this.q===4){var n=_a.c.b(_ad.c.a,"AttachmentLightboxCloseEdit",!1,null);n.m=this.bS?"ClosedByBackButton":this.bv?"ClosedBySendingMessage":"DiscardedFromComposeForm";n.r=new _a.bu(106,2,!0);_a.c.a(n)}if(this.bc){var t=_a.c.b(_ad.c.a,"AttachmentLightboxClose",!1,null);t.r=new _a.bu(105,2,!0);this.bc();_a.c.a(t)}this.cl&&this.cl(this);this.cq=!1;this.fn()}},eE:function(n){switch(_a.bd.a(n).toLowerCase()){case".vsd":case".vdx":case".vss":case".vsx":case".vst":case".vtx":case".vsdx":case".vsdm":return!0;default:return!1}}};_ad.J=function(n,t,i,r,u){this.l=-1;_ad.J.initializeBase(this);this.m(n.e());this.e=t;this.c=i;this.d=r;this.b=u};_ad.J.prototype={e:null,a:null,f:!1,c:null,d:null,b:!1,m:function(n){if(this.a!==n){this.a=n;this.g(!0);this.eH("MediaUrl")}return n},h:function(){return this.b?"":this.a},g:function(n){this.f!==n&&(this.f=n);return n},j:function(){this.c&&this.c()},i:function(){this.d&&this.d("MediaFailedToLoad")}};_ad.Z=function(){};_ad.Z.prototype={a:function(n,t,i,r,u){return new _ad.J(n,t,i,r,u)}};_ad.x=function(n,t,i,r,u,f,e,o,s){this.m=Function.createDelegate(this,this.s);this.n=Function.createDelegate(this,this.t);_ad.x.initializeBase(this);this.a=n;this.l=n.d();this.f=t;this.d=i;this.j=r;this.b=u;this.e=f;this.c=e;this.o=o;this.i=s;this.r()};_ad.x.prototype={a:null,g:null,l:null,f:null,d:null,b:null,j:null,c:!1,o:null,i:null,e:null,p:function(n){if(this.g!==n){this.g=n;this.eH("TextContent")}return n},q:function(){return this.c?"":this.l},h:function(){return!!this.a&&!_j.h.a(this.a.e())},r:function(){var n=null;n=this.h()?new _ad.E(this.a.e(),this.a.g()):new _ad.Q(this.a.a().Id,this.i);n.b(this.n);n.c(this.m);this.j.a(n)},t:function(n){if(this.h()){var t=n;this.p(t.N.Content)}else{var i=n;this.p(i.N.Content)}if(this.b){this.b();this.b=null}},s:function(n){var t=_ads.B.X;if(!this.h()){var i=n;if(i&&i.N)switch(i.N.Status){case 2:t=_ads.B.H;break;case 3:t=_ads.B.A;break;default:break}}var r=this;this.u(0,t,function(n,t){r.d.k()});this.e&&this.e(n.O())},u:function(n,t,i){this.f&&this.f(n,t,i)}};_ad.t=function(n,t){_ad.t.initializeBase(this);this.d(n);this.e(t);this.f(!0)};_ad.t.prototype={a:null,b:null,c:!1,d:function(n){if(this.a!==n){this.a=n;this.eH("Message")}return n},e:function(n){if(this.b!==n){this.b=n;this.eH("FileName")}return n},f:function(n){if(this.c!==n){this.c=n;this.eH("IsLoading")}return n}};_ad.m=function(n,t,i,r,u,f,e,o,s,h,c){this.p=Function.createDelegate(this,this.N);this.B=Function.createDelegate(this,this.M);this.A=Function.createDelegate(this,this.J);this.z=Function.createDelegate(this,this.C);_ad.m.initializeBase(this);this.b=n;this.o=e;this.i=t;this.t=i;this.l=r;this.v=o;this.n=s;this.r=u;this.s=f;this.q=new _j.g(this.z,_ad.m.a);this.u=new _j.g(this.A,_ad.m.a);this.w=h;this.x=c;this.H()};_ad.m.prototype={s:null,r:null,l:null,t:null,i:null,b:null,q:null,u:null,v:null,e:null,c:null,f:null,a:null,j:null,m:!1,h:null,g:null,d:null,o:null,n:!1,w:null,x:null,K:function(){return this.j||_nbs.a.JQ},E:function(n){if(this.j!==n){this.j=n;this.eH("AddToCalendarCommandText")}return n},G:function(n){if(this.m!==n){this.m=n;this.eH("IsActionExecuting")}return n},L:function(){return this.n?"":this.t.a(this.b.a(),!1,_g.C.a(),this.v)},O:function(n){if(n!==this.c){this.c&&this.c.dispose();this.c=n;this.eH("CalendarItemDetailsViewModel")}return n},eJ:function(){var n;_a.h.a(n={val:this.c});this.c=n.val;var t;_a.h.a(t={val:this.a});this.a=t.val;_a.gb.prototype.eJ.call(this)},J:function(){var n=_a.c.b(_ad.m.a,"DownloadIcsAttachmentFromSxS",!0,null);if(this.l){var t=this.b.c();var i=_a.bd.a(this.b.b());this.l.c(new _g.e(this.b.a()?this.b.a().RootItemId:null),"Downloaded",i,t)}_a.c.a(n)},H:function(){this.h=_a.c.b(_ad.m.a,"PreviewIcs",!0,null);this.g=_a.c.b(_ad.m.a,"ConvertIcsToCalendarItem",!0,null);if(this.a)this.D();else{var n=this;this.s.a(function(t){n.a=t.a();n.D()})}if(this.e)this.y();else{var t=this;this.r.a(function(n){t.e=n;t.y()})}},D:function(){this.a.a(this.b.a().Id);this.a.f(this.B)},M:function(n,t,i){if(_j.h.a(n)){_a.c.a(this.g);this.f=i;this.y()}else{this.g.p=n;_a.c.a(this.g);this.h.p=n;_a.c.a(this.h);this.x(n);if(t){var r=this;this.i(2,n,function(n,t){n&&r.C()})}else this.i(0,n,null)}},y:function(){if(this.f&&this.e){this.f.O().c("HTML");var n=this;this.O(this.e.c(this.f,function(t){_a.c.a(n.h)},!0));this.w()}},C:function(){this.d=_a.c.b(_ad.m.a,"AddIcsToCalendarFromSxs",!0,null);this.G(!0);this.E(_nbs.a.Mp);this.a.e(this.b.b());this.a.a(this.b.a().Id);this.a.b(this.p);this.a.c()},N:function(n){this.G(!1);this.E(_nbs.a.JQ);this.a.d(this.p);if(_j.h.a(n)){_a.c.a(this.d);this.o.k()}else{this.d.p=n;_a.c.a(this.d);this.i(0,_nbs.a.Kp,null)}}};_ad.i=function(n,t,i,r,u,f,e,o,s,h,c){this.L=Function.createDelegate(this,this.bt);this.K=Function.createDelegate(this,this.bs);this.W=Function.createDelegate(this,this.bu);this.V=Function.createDelegate(this,this.bl);this.X=Function.createDelegate(this,this.bv);this.Y=Function.createDelegate(this,this.bw);this.s=-1;_ad.i.initializeBase(this);if(f){this.r=f.a().hN().Enabled;this.D=f.a().b().Enabled}this.M=e;this.T=t;this.m=n.k();this.y=n.h();this.S(n,!0);this.be(n.c());this.E=i;this.G=r;this.d=u;this.C=o;this.q=s;this.t=h;this.bh=c;this.J=new _y.bC;this.P=new _j.g(this.Y,_a.a.c);this.O=new _j.g(this.X,_a.a.c);this.ba=new _j.g(this.V,_a.a.c);this.N=new _j.g(this.W,_a.a.c);this.i=!1;this.d.apcl("ReadingPaneWidth",this.K);this.d.apcl("ShowReadingPane",this.L);this.bi()};_ad.i.c=function(n){if(_ad.i.a.d.length>0)for(var t=_ad.i.a.d.length-1;t>=0;t--){n.c(_ad.i.a.d[t]);_ad.i.a.j(t)}};_ad.i.prototype={C:null,P:null,O:null,ba:null,N:null,T:null,J:null,f:null,a:null,p:null,z:0,c:null,B:null,bc:null,o:!1,w:!1,v:!1,e:0,H:!1,j:!1,M:null,A:null,g:null,E:null,G:null,r:!1,i:!1,d:null,D:!1,t:null,q:!1,bh:null,l:!1,m:null,y:null,u:function(n){if(this.o!==n){this.o=n;this.eH("ShowPrevNextButtons")}return n},R:function(n){if(this.w!==n){this.w=n;this.eH("ShowPrevButton")}return n},Q:function(n){if(this.v!==n){this.v=n;this.eH("ShowNextButton")}return n},U:function(){if(this.o)if(this.e)if(this.e===this.a.d.length-1){this.R(!0);this.Q(!1)}else{this.R(!0);this.Q(!0)}else{this.Q(!0);this.R(!1)}},bB:function(n){if(this.c!==n){this.n(!0);this.c=n;this.eH("ImagePreviewUrl")}return n},bb:function(){return this.q?"":this.B},bz:function(n){if(this.B!==n){this.B=n;this.eL("ImageDownloadUrl","HideDownloadButton")}return n},bm:function(){return _j.h.a(this.bb())},x:null,bf:function(n){if(this.s!==n){this.s=n;this.eH("ReadingPaneSize")}return n},bo:function(){return!(this.D&&this.j)},bA:function(n){if(this.a!==n){this.a=n;if(this.a.d.length>1)for(var t=0;t<this.a.d.length;t++)if(this.j){if(this.a.d[t].e()===this.c){this.e=t;break}}else if(this.a.d[t].a()&&this.c.indexOf(encodeURIComponent(this.a.d[t].a().Id))!==-1||!this.a.d[t].a()&&this.a.d[t].e()===this.c){this.e=t;break}this.r&&this.bg()}return n},bx:function(n){if(this.p!==n){this.p=n;this.eH("CurrentImageAttachmentName")}return n},b:function(){if(!this.r)return null;this.g||this.Z();return this.g},bC:function(n){if(this.g!==n){this.g=n;this.eH("ImageStripViewModel")}return n},h:function(n){if(this.i!==n){this.i=n&&this.r?!0:!1;this.eH("ShowFilmstrip")}return n},by:function(n){if(this.z!==n){this.z=n;this.eH("CurrentImageAttachmentSize")}return n},n:function(n){if(this.H!==n){this.H=n;this.eH("Loading")}return n},be:function(n){if(this.j!==n){this.j=n;this.eH("IsReferenceAttachment")}return n},bw:function(){this.bd(!1)},bv:function(){this.bd(!0)},bl:function(){if(this.C&&this.f){var n=this.f.c();var t=_a.bd.a(this.f.b());this.C.c(new _g.e(this.f.a()?this.f.a().RootItemId:null),"Download",t,n)}},bu:function(){this.J.a(this.f.j(),"_blank")},bd:function(n){if(this.a){var i=_a.c.b(_ad.i.b,n?"AttachmentLightBoxNextImage":"AttachmentLightBoxPreviousImage",!1,null);var u=this.bp();var r=this.a.d.length;var t=(n?this.e+1:this.e-1)%r;t===-1&&(t=r-1);this.e=t;this.S(this.a.d[t],!0);i.m=u;_a.c.a(i);this.U()}},S:function(n,t){this.f=n;this.bx(n.b());this.by(n.f());this.x=n.a();this.bc=n.g();this.bz(n.i());this.be(n.c());this.bB(n.e());this.T(n.a());t&&this.b()&&this.b().a(this.c)},bn:function(){return!_a.g.b&&!!this.t&&!this.D&&this.f.l()&&!!this.x},bp:function(){var n=new _a.l;this.a?n.a("C",this.a.d.length):n.b("C","");n.b("T",_a.bd.a(this.p));n.a("S",this.s);return n.toString()},br:function(){this.E&&this.E()},bq:function(){this.G&&this.G("ImageFailedToLoad")},bg:function(){if(this.b()&&this.a){this.b().c();for(var n=0;n<this.a.d.length;n++)this.b().b(this.a.d[n].b(),this.a.d[n].e(),this.a.d[n].m(),this.a.d[n].g());this.b().a(this.c)}},bD:function(n,t){if(n!==-1){this.e=n;this.S(this.a.d[n],t)}},Z:function(){if(!this.g)if(this.A){this.bC(this.A.a());this.bg()}else{var n=this;this.M.a(function(t){n.A=t;n.Z()})}},eJ:function(){var n;_a.h.a(n={val:this.g});this.g=n.val;this.d.rpcl("ReadingPaneWidth",this.K);this.d.rpcl("ShowReadingPane",this.L);_a.gb.prototype.eJ.call(this)},bi:function(){var n=new _j.q;this.m?this.bk(n):this.y&&this.bj(this.y,n);var t=n.d.length;if(t>0){this.bA(n);if(t>1&&this.l){this.u(!0);this.h(!this.d.a);this.U()}else{this.u(!1);this.h(!1)}}},bj:function(n,t){if(n.a().x.length>0){this.l=!0;for(var u=n.a(),r=0;r<u.b();r++){var i=u.c(r);var e=i.bl;if(!e.a())if(i.br()===1||i.br()===2){var f=new _ad.e;f.p(i);t.c(f)}else this.l=!1}}},bk:function(n){this.l=!0;for(var t=0;t<this.m.length;t++)this.m[t]&&n.c(_ad.e.g(this.m[t]))},bt:function(n,t){if(this.a&&this.a.d.length>1&&(this.l||!this.d.a)){this.u(!0);this.h(!this.d.a)}else{this.u(!1);this.h(!1)}},bs:function(n,t){this.bf(this.d.c)}};_ad.G=function(n,t,i,r,u){this.c=n;this.a=t;this.d=i;this.e=r;this.b=u};_ad.G.prototype={a:null,c:null,d:null,e:null,b:null,f:function(n,t,i,r,u,f){return new _ad.i(n,t,i,r,u,this.a,this.b,this.c,f,this.d,this.e)}};_ad.bg=function(n,t,i){this.v=Function.createDelegate(this,this.D);this.u=Function.createDelegate(this,this.C);this.t=Function.createDelegate(this,this.k);_ad.bg.initializeBase(this);this.j=n;this.e(!1);this.g=t;this.n=i;this.m=new _j.g(this.t,_a.a.c);this.p=new _j.g(this.u,_a.a.c);this.s=new _j.g(this.v,_a.a.c)};_ad.bg.prototype={a:!0,i:!1,f:!1,c:0,b:!1,h:!1,j:null,l:null,m:null,o:null,p:null,r:null,s:null,n:!1,q:!1,x:function(){return 480},d:function(n){if(this.a!==n){if(n&&this.f)return n;this.a=n;this.eH("ShowReadingPane")}return n},E:function(n){if(this.i!==n){this.i=n;this.eH("HideShowHideEmailButtonInAttachmentSideOfLightbox")}return n},z:function(n){if(this.f!==n){this.f=n;this.eH("ShouldAlwaysHideReadingPane");this.f&&this.d(!1)}return n},G:function(n){if(this.b!==n){this.b=n;this.eH("IsEditMode")}return n},y:function(n){if(this.c!==n){this.c=n;this.eH("DocumentToolbarWidth");this.eH("ReadingPaneWidth")}return n},w:function(){return 0},e:function(n){var t;t=this.j?_j.k.i(this.j.document.body):_j.k.i(document.body);this.H(t,n)},H:function(n,t){_j.e.a(_a.a.c,"Set aspect ratio width: {0}, isUserAction",n,t);if(!t&&!this.h){var r=this.b?1366:1152;this.d(n>=r)}if(this.a){var i=Math.floor(Math.max(n/(1+1.89),this.x()));_j.e.a(_a.a.c,"Set reading pane width: {0}; attachment view width: {1}; total width: {2}",i,n-i,n);this.y(i)}else this.y(0);t&&!this.h&&(this.h=!0)},B:function(){return this.f||!this.q&&this.a||this.i},g:!1,A:function(){return this.g||this.a||this.n},J:function(n,t,i){this.l=n;this.o=t;this.r=i},k:function(){this.l()},C:function(){this.o();this.eV("HidePopoutButtonInAttachmentSideOfLightbox","HideCloseButton","HideShowHideEmailButtonInAttachmentSideOfLightbox")},D:function(){this.r()}};_ad.I=function(n,t,i){_ad.I.initializeBase(this,[n,t,i])};_ad.I.prototype={w:function(){return this.a?this.c:0}};_ad.Y=function(n,t){_ad.Y.initializeBase(this,[n,t,!1])};_ad.Y.prototype={x:function(){return 380}};_ad.bh=function(){_a.g.g().a(this)};_ad.bh.prototype={o:!0,a:null,dispose:function(){_a.g.g().b(this)}};_ad.W=function(n,t,i,r){this.e=Function.createDelegate(this,this.p);this.f=Function.createDelegate(this,this.q);_ad.W.initializeBase(this);this.i=n;this.h=t;this.g=i;this.d=r;i.b(_db.ck,this.f)};_ad.W.prototype={i:null,h:null,g:null,d:0,b:null,c:null,j:function(){return!!this.c},m:function(){var n=this.a.bz(null);if(this.b){if(this.d==="Mouse")if(this.a.u){this.a.s.d(this.b);this.a.i.v().c(this.b)}else this.a.dM().e(this.b);else this.a.bj.a();this.a.bp(4);_y.l.a(null,"ReplyWithChanges","","",n)}else this.l(this.a.w.AttachmentId.RootItemId)},k:function(){var n=null;n=this.a.q===1&&this.a.i.c()&&_y.i.isInstanceOfType(this.a.i.c())?this.a.i.c():this.b;n&&n.j(null,null)},n:function(){var n=this;this.c.j(function(t){n.r()},null)},r:function(){this.l(this.a.ev())},q:function(n){if(this.a&&this.a.o){this.a.o.g=n.a();this.c=n.b()}},l:function(n){var t=this;this.h.a(function(i){var f=t.a.bz(null);var u=function(n){t.i.a(function(i){t.b=i.a(n,null,null);t.b.O(!0);t.b.m(t.a.bH);if(t.o){t.a.cA=t.b.ft();t.b.fK(t.a.be);t.b.be().i(t.a.bM)}t.a.u?t.a.i.v().c(t.b):t.a.dM().e(t.b);t.d==="TouchWide"&&t.b.eR(t.e);t.a.bp(4);_y.l.a(null,"ReplyWithChanges","","",f)})};if(t.c)u(t.c.a());else{var r=0;t.a.bN?r=t.a.bN.h()==="HTML"?3:1:t.a.i&&_y.i.isInstanceOfType(t.a.i.c())&&t.a.i.c().a()&&(r=t.a.i.c().a().h()==="HTML"?3:1);r?u(i.b(new _g.e(n),!1,r,null)):t.a.dR(n,function(n){u(i.b(n.bD.ItemId,!1,_g.g.d(n),n.bV()))},!0)}})},p:function(){this.a.fB(this.b);this.b.fG(this.e)},dispose:function(){this.g.c(_db.ck,this.f);_ad.bh.prototype.dispose.call(this)}};_ad.ba=function(n){_ad.ba.initializeBase(this,[n]);this.z.setAttribute("FrameBorder","1")};_ad.ba.prototype={d:function(n){this.z.setAttribute("Controls",n);return n},b:function(n){this.z.setAttribute("Autoplay",n);return n}};_ad.y=function(n){this.g=Function.createDelegate(this,this.k);_ad.y.initializeBase(this,[n]);this.y("DocumentPreview")};_ad.y.prototype={a:null,b:null,d:null,c:null,e:null,f:!1,h:function(n){if(this.f!==n){this.f=n;this.bw("ShowErrorMessageLabel")}return n},H:function(){_j.c.prototype.H.call(this);if(this.B){this.d=this.B.a("ElementContainingEmbed");this.c=this.B.a("IFrameDocumentPreview")}},G:function(){_j.c.prototype.G.call(this);this.e=this.V();this.d&&(this.e.b?this.l():this.j(this.e))},M:function(){_j.c.prototype.M.call(this);this.i()},j:function(n){this.i();var t=n.h;t!=="application/pdf"&&(t="text/html");this.a=new _be.e(window.document.createElement("object"));this.a.a(n.a+"#toolbar=0");this.a.b(t);_j.k.a(this.a.z,"height","100%");_j.k.a(this.a.z,"width","100%");_j.k.a(this.a.z,"background",String.format("url({0}) no-repeat center",_y.c.a.p("loading_spinner_64x64.gif")));_j.k.b(this.a.z,"load",this.g);this.b=new _be.d(window.document.createElement("embed"));this.b.a(n.a);this.b.b(t);_j.k.a(this.b.z,"height","100%");_j.k.a(this.b.z,"width","100%");this.h(!1);this.a.z.appendChild(this.b.z);this.d.z.appendChild(this.a.z)},i:function(){if(this.a){if(this.b){this.a.z.removeChild(this.b.z);this.b=null}this.d.z.removeChild(this.a.z);this.a=null}},l:function(){_j.k.a(this.c.z,"height","100%");_j.k.a(this.c.z,"width","100%");_j.k.a(this.c.z,"background",String.format("url({0}) no-repeat center",_y.c.a.p("loading_spinner_64x64.gif")));_j.k.b(this.c.z,"load",this.g);this.h(!1)},k:function(n){var t=this;_j.m.a().a(_a.a.c,"DocumentPreview.OnObjectLoaded",function(){_j.k.a(t.a.z,"background","");_j.k.a(t.c.z,"background","");t.h(!0)},1e3);_j.k.c(this.c.z,"load");_j.k.c(this.a.z,"load")}};_ad.b=function(){};_ad.b.o=function(){return _fm.b.a(_fm.a.a,_fm.WebfontSizes.a.b,"ms-fcl-ns-b")};_ad.b.x=function(){return _fm.b.b(_fm.a.eG,null,[_fm.WebfontSizes.a.e,"ms-fcl-ts-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.e=function(){return _fm.b.b(_fm.a.W,null,[_fm.WebfontSizes.a.e,"ms-fcl-ts-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.f=function(){return _fm.b.b(_fm.a.W,null,[_fm.WebfontSizes.a.e,"ms-fcl-tl-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.n=function(){return _fm.b.b(_fm.a.W,null,[_fm.WebfontSizes.a.e,"ms-fcl-tp-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.k=function(){return _fm.b.b(_fm.a.W,null,[_fm.WebfontSizes.a.e,"ms-fcl-nlr-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.l=function(){return _fm.b.b(_fm.a.W,null,[_fm.WebfontSizes.a.e,"ms-fcl-ns-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.m=function(){return _fm.b.b(_fm.a.W,null,[_fm.WebfontSizes.a.e,"ms-fcl-w-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.v=function(){return _fm.b.b(_fm.a.bW,null,[_fm.WebfontSizes.a.e,"ms-fcl-w-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.w=function(){return _fm.b.b(_fm.a.bW,null,[_fm.WebfontSizes.a.e,"ms-fcl-w-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.p=function(){return _fm.b.b(_fm.a.bW,null,[_fm.WebfontSizes.a.e,"ms-fcl-w-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.q=function(){return _fm.b.b(_fm.a.bW,null,[_fm.WebfontSizes.a.e,"ms-fcl-w-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.c=function(){return _fm.b.b(_fm.a.a,null,[_fm.WebfontSizes.a.e,"ms-fcl-ts-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.d=function(){return _fm.b.b(_fm.a.a,null,[_fm.WebfontSizes.a.e,"ms-fcl-tp-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.i=function(){return _fm.b.b(_fm.a.a,null,[_fm.WebfontSizes.a.e,"ms-fcl-nlr-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.j=function(){return _fm.b.b(_fm.a.a,null,[_fm.WebfontSizes.a.e,"ms-fcl-w-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.a=function(){return _fm.b.b(_fm.a.G,null,[_fm.WebfontSizes.a.e,"ms-fcl-ts-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.b=function(){return _fm.b.b(_fm.a.G,null,[_fm.WebfontSizes.a.e,"ms-fcl-tp-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.g=function(){return _fm.b.b(_fm.a.G,null,[_fm.WebfontSizes.a.e,"ms-fcl-nlr-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.h=function(){return _fm.b.b(_fm.a.G,null,[_fm.WebfontSizes.a.e,"ms-fcl-w-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.r=function(){return _fm.b.b(_fm.a.by,null,[_fm.WebfontSizes.a.e,"ms-fcl-nlr-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.s=function(){return _fm.b.b(_fm.a.by,null,[_fm.WebfontSizes.a.e,"ms-fcl-w-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.t=function(){return _fm.b.b(_fm.a.Z,null,[_fm.WebfontSizes.a.e,"ms-fcl-nlr-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.u=function(){return _fm.b.b(_fm.a.Z,null,[_fm.WebfontSizes.a.e,"ms-fcl-w-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.y=function(){return _fm.b.b(_fm.a.c,null,[_fm.WebfontSizes.a.e,"ms-fcl-ts-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.b.z=function(){return _fm.b.b(_fm.a.c,null,[_fm.WebfontSizes.a.e,"ms-fcl-tp-b"],null,null,null,null,["ms-icon-flip-glyph"])};_ad.o=function(n,t,i,r){this.k=Function.createDelegate(this,this.ch);this.i=Function.createDelegate(this,this.cc);this.l=Function.createDelegate(this,this.ci);this.D=Function.createDelegate(this,this.bZ);this.bf=Function.createDelegate(this,this.cg);this.bc=Function.createDelegate(this,this.ca);this.be=Function.createDelegate(this,this.cb);this.j=Function.createDelegate(this,this.ce);this.w=Function.createDelegate(this,this.bR);this.x=Function.createDelegate(this,this.bS);this.bh=Function.createDelegate(this,this.bs);this.bk=Function.createDelegate(this,this.bt);_ad.o.initializeBase(this,[n]);this.e=t;this.h=i;this.n=r;this.r=new _j.g(this.bk,_a.a.c);this.q=new _j.g(this.bh,_a.a.c);this.o=new _j.g(this.x,_a.a.c);this.m=new _j.g(this.w,_a.a.c);this.g=!0;this.y("ImagePreviewLightBox")};_ad.o.prototype={r:null,q:null,o:null,m:null,s:0,e:null,h:null,b:null,c:null,g:!1,t:!1,v:0,n:null,d:null,p:0,a:null,u:!1,cm:function(n){this.s=n;this.Z()&&this.f();return n},cn:function(n){this.t!==n&&(this.t=n);return n},cj:function(n){if(this.g!==n){this.g=n;this.bw("HideFullscreenButton")}return n},bC:function(n){if(this.a!==n){this.bN();this.a=n;this.bP()}return n},ce:function(){this.f()},G:function(){_j.c.prototype.G.call(this);this.bC(this.V());this.e&&this.e.h(this.j);this.f();this.b&&this.b.z.complete&&this.a.n(!1);if(this.b){_j.k.b(this.b.z,"load",this.be);_j.k.b(this.b.z,"error",this.bc);_j.k.b(this.b.z,"contextmenu",this.bf);if(this.e.a()!=="Mouse"){_b.g.g(this.b.z,null);var t=this;_b.g.a(this.b.z,function(n){t.bY(n)},null,!1,!1)}}this.c&&_j.k.b(_j.x.a(this.c.z).documentElement,"MSFullscreenChange webkitfullscreenchange mozfullscreenchange fullscreenchange",this.D,"ImagePreview");this.bH();var n=this;_j.m.a().a(_a.a.c,"ImagePreview:OnActivate",function(){n.V()&&n.a.o&&(n.a.v?n.B.a("RightArrow").z.focus():n.a.w&&n.B.a("LeftArrow").z.focus())},1e3)},Y:function(){_j.i.prototype.Y.call(this);this.bC(this.V())},bP:function(){if(this.a){this.a.n(!1);this.a.apcl("ShowPrevNextButtons",this.l);this.a.apcl("ImagePreviewUrl",this.i);this.a.b()&&this.a.b().apcl("SelectedItem",this.k)}},bN:function(){if(this.a){this.a.rpcl("ShowPrevNextButtons",this.l);this.a.rpcl("ImagePreviewUrl",this.i);this.a.b()&&this.a.b().rpcl("SelectedItem",this.k)}},bq:function(){if(this.d){this.d.b(!1);this.d=null}},M:function(){_j.c.prototype.M.call(this);if(this.b){_j.k.c(this.b.z,"load");_j.k.c(this.b.z,"error");_j.k.c(this.b.z,"contextmenu")}this.c&&_j.k.c(_j.x.a(this.c.z).documentElement,"MSFullscreenChange webkitfullscreenchange mozfullscreenchange fullscreenchange","ImagePreview");if(this.B&&this.B.a("ImageAttachment")){var n=this.B.a("ImageAttachment");_j.k.a(n.z,"max-height","0px");_j.k.a(n.z,"max-width","0px")}this.bN();this.e&&this.e.j(this.j)},H:function(){_j.c.prototype.H.call(this);if(this.B){this.b=this.B.a("ImageAttachment");this.c=this.B.a("FullscreenContainer");this.cq()}else this.b=null},cq:function(){this.cj(!this.bQ())},bQ:function(){return this.br()?!0:!1},ci:function(n,t){this.f()},bM:function(n){this.n.a(_a.u,new _a.u([n],0,null,0,!1,null,null,null))},f:function(){if(this.B){var t;t=this.c?this.c:this.B.a("ImagePanel");var i=_j.k.i(t.z);var r=_j.k.g(t.z);var e=.89*i;var o=.89*r;_j.k.B(this.z).focus();this.z.focus();var u=this.B.a("ImageContainer").z;_j.k.a(u,"width",i+"px");_j.k.a(u,"height",r+"px");if(this.b){var f=this.b.z;_j.k.a(f,"max-width",e+"px");_j.k.a(f,"max-height",o+"px")}var n=this.B.a("loadingIcon");if(n){_j.k.a(n.z,"top",(r-_j.k.g(n.z))/2+"px");_j.k.a(n.z,_fc.m.a(),(i-_j.k.i(n.z))/2+"px")}}},bt:function(){this.a.P.a()},bs:function(){this.a.O.a()},br:function(){if(!this.c)return null;var n=this.c.z;if(n.requestFullscreen){var t=n;return t.$$d_requestFullscreen||(t.$$d_requestFullscreen=Function.createDelegate(t,t.requestFullscreen))}else if(n.msRequestFullscreen){var i=n;return i.$$d_msRequestFullscreen||(i.$$d_msRequestFullscreen=Function.createDelegate(i,i.msRequestFullscreen))}else if(n.webkitRequestFullscreen){var r=n;return r.$$d_webkitRequestFullscreen||(r.$$d_webkitRequestFullscreen=Function.createDelegate(r,r.webkitRequestFullscreen))}else if(n.mozRequestFullScreen){var u=n;return u.$$d_mozRequestFullScreen||(u.$$d_mozRequestFullScreen=Function.createDelegate(u,u.mozRequestFullScreen))}return null},bV:function(){if(!this.c)return null;var n=_j.x.a(this.c.z);if(n.exitFullscreen){var t=n;return t.$$d_exitFullscreen||(t.$$d_exitFullscreen=Function.createDelegate(t,t.exitFullscreen))}else if(n.msExitFullscreen){var i=n;return i.$$d_msExitFullscreen||(i.$$d_msExitFullscreen=Function.createDelegate(i,i.msExitFullscreen))}else if(n.webkitExitFullscreen){var r=n;return r.$$d_webkitExitFullscreen||(r.$$d_webkitExitFullscreen=Function.createDelegate(r,r.webkitExitFullscreen))}else if(n.mozCancelFullScreen){var u=n;return u.$$d_mozCancelFullScreen||(u.$$d_mozCancelFullScreen=Function.createDelegate(u,u.mozCancelFullScreen))}return null},bX:function(){if(!this.c)return null;var n=_j.x.a(this.c.z);if(n.fullscreenElement)return n.fullscreenElement;else if(n.msFullscreenElement)return n.msFullscreenElement;else if(n.webkitFullscreenElement)return n.webkitFullscreenElement;else if(n.mozFullScreenElement)return n.mozFullScreenElement;return null},bS:function(){var n=this.br();n&&n()},bZ:function(n){if(this.a)if(this.bX()){this.u=this.a.i;this.a.h(!0)}else this.a.h(this.u)},bR:function(){var n=this.bV();n&&n()},ch:function(n,t){var r=this.a.b().d();if(r!==-1&&this.a.e!==r){this.bq();var i=this;this.d=this.h.c(26,this.b.z,function(){i.d=null;i.p=22;i.b.K(!0);if(i.a&&i.a.b()){var n=i.a.b().e();n&&i.a.bD(r,!1)}});this.d.a()}},cb:function(n){if(this.b.bo()){this.b.K(!1);this.bq();var t=this;this.d=this.h.c(this.p,this.b.z,function(){t.d=null});this.d.a()}this.a.n(!1);this.f();this.a.U();this.a.br()},ca:function(n){this.a.n(!1);if(this.a.j){_j.e.a(_a.a.c,"Could not display the shared image attachment. The image was moved or deleted or user haven't accessed the Data Provider");this.bM(_nbs.a.FF)}else{_j.e.a(_a.a.c,"Could not display image attachment.");this.bM(_nbs.a.NR)}this.a.bq()},cg:function(n){this.a.q&&n.c()},bY:function(n){this.v=n.e();var t=this;_b.g.b(this.b.z,function(n){var i=n.e()-t.v;i<0&&t.bs();i>0&&t.bt();_b.g.c(t.b.z,null)},null)},bH:function(){if(this.b&&this.b.c()!==this.a.c){this.a.n(!0);this.a.bn()?this.cr():this.b.a(this.a.c)}},cr:function(){var u=this.a.x.Id+"Preview";var f=this.a.t.a(u);if(!_j.h.a(f)){this.b.a(null);this.b.a(f);return}var i=document.createElement("canvas");var e=i.getContext("2d");var n=new Image;n.crossOrigin="Anonymous";var t=this;n.onload=function(){if(t&&!t.bK){var f=n.width,o=n.height;i.width=f;i.height=o;var r=null;try{if(f>0&&o>0){e.drawImage(n,0,0,f,o);r=i.toDataURL("image/jpeg",.5)}}catch(s){_j.e.b(_a.a.c,"Failed to get thumbnail via canvas error={0}",s.message)}t.b.a(null);t.b.a(r?r:t.a.c);if(r)try{t.a.t.b(u,r);_ad.i.a.c(u)}catch(h){_j.e.b(_a.a.c,"Failed to save thumbnailinfo into session storage, error={0}",h.message)}}};var r=this;n.onerror=function(){r&&!r.bK&&r.b.a(r.a.c)};n.src=this.a.c},cc:function(n,t){this.bH()}};_ad.u=function(n,t,i,r){this.i=Function.createDelegate(this,this.m);this.e=Function.createDelegate(this,this.k);this.f=Function.createDelegate(this,this.l);_ad.u.initializeBase(this,[n]);this.a=t;this.b=i;this.d=r};_ad.u.prototype={a:null,b:null,d:null,h:"LightBoxView",g:null,c:null,k:function(){_j.e.a(_a.a.c,"Attachment light box resized.");var n=this.V();n.j&&n.j.e(!1)},bx:function(){this.a.b()||this.j();_j.c.prototype.bx.call(this)},bI:function(){this.by();_j.c.prototype.bI.call(this)},G:function(){_j.c.prototype.G.call(this);this.a.b()||this.n();var n=this.V();n.j&&n.j.apcl("ShowReadingPane",this.f);this.a.h(this.e)},M:function(){this.a.b()||this.j();var n=this.V();n&&n.j&&n.j.rpcl("ShowReadingPane",this.f);this.a.j(this.e);_j.c.prototype.M.call(this)},H:function(){_j.c.prototype.H.call(this);if(this.B){this.g=this.B.a("attachmentViewElement");this.c=this.B.a("readingPaneElement")}else{this.g=null;this.c=null}},l:function(n,t){var i=this.V();i.j.a?this.d.c(28,this.c.z,null).a():this.d.c(32,this.c.z,null).a()},n:function(){_j.k.b(document.body,"keydown",this.i,this.h)},j:function(){_j.k.c(document.body,"keydown",this.h)},m:function(n){if(n.a()===117&&n.i()&&!n.l())if(n.g()&&this.b.b().b){this.b.b().d();n.c()}else if(this.b.a().b){this.b.a().d();n.c()}}};_ad.v=function(n,t){this.c=Function.createDelegate(this,this.e);this.d=Function.createDelegate(this,this.f);_ad.v.initializeBase(this,[n]);this.y("MediaPreview");this.b=t};_ad.v.prototype={a:null,b:null,G:function(){_j.c.prototype.G.call(this);if(this.B){this.a=this.B.a("MediaAttachment");if(this.a){_j.k.b(this.a.z,"error",this.d);_j.k.b(this.a.z,"canplay",this.c)}}},M:function(){_j.c.prototype.M.call(this);if(this.a){_j.k.c(this.a.z,"error");_j.k.c(this.a.z,"canplay")}},e:function(n){var t=this.V();t.g(!1);t.j()},f:function(n){_j.e.a(_a.a.c,"Could not display media attachment.");this.g(_nbs.a.qk);var t=this.V();t.g(!1);t.i()},g:function(n){this.b.a(_a.u,new _a.u([n],0,null,0,!1,null,null,null))}};_ad.bb=function(n){_ad.bb.initializeBase(this,[n])};_ad.a=function(){};_ad.a.$$cctor=function(){_ad.a._I()};_ad.a.bS=function(){var n=window.document.createElement("DIV");n.innerHTML="<div> <button type='button' class='_ad_4 ms-font-weight-regular ms-font-m'></button> </div><div> <div class='_ad_6'> <a></a> <a></a> <button type='button' class='_ad_4 ms-font-weight-regular ms-font-color-neutralTertiaryAlt'></button> <button type='button' class='_ad_4 ms-font-weight-regular ms-font-m'></button> </div> <div class='_ad_7'> <button type='button' class='ms-bg-color-themeLight-hover _ad_5'></button> <button type='button' class='_ad_5 ms-bg-color-themeLight-hover'></button> </div> </div><div> <div class='_ad_2'> <div class='_ad_3 ms-bg-color-themeLighterAlt'></div> <div CssClass=\"previewContainer\">   <iframe></iframe>  <span class='_ad_a ms-font-m ms-font-weight-regular ms-font-color-neutralSecondary'></span> </div> </div> </div><div> <button type='button' class='_ad_g ms-font-weight-regular ms-font-m'></button> </div><div> <div class='_ad_d'> <a class='_ad_k'></a> <button type='button' class='_ad_g ms-font-weight-regular ms-font-color-neutralTertiaryAlt'></button> <button type='button' class='_ad_g ms-font-weight-regular ms-font-m'></button> <button type='button' class='_ad_g ms-font-weight-regular ms-font-m'></button> </div> <div class='_ad_e'> <button type='button' class='ms-bg-color-themeLight-hover _ad_h'></button> <button type='button' class='_ad_h ms-bg-color-themeLight-hover'></button> </div> </div><div> <div class='_ad_b'> <div class='_ad_c ms-bg-color-themeLighterAlt'></div> <div class='_ad_l'></div>  <div class='_ad_j ms-font-b ms-font-weight-regular ms-font-color-neutralPrimary'></div>  <div class='_ad_i ms-bg-color-neutralTertiaryAlt'></div> </div> </div><div> <button type='button' class='_ad_v ms-font-weight-regular ms-font-color-neutralLighter'></button> </div><div> <span class='_ad_B'></span> </div><div> <div class='_ad_y'></div> </div><div> <div class='_ad_m'> <div class='_ad_r ms-bg-color-neutralDark'> <div class='_ad_F'> <a></a> <button type='button' class='_ad_v ms-font-weight-regular ms-font-color-neutralSecondary'></button> <button type='button' class='_ad_v ms-font-weight-regular ms-font-color-neutralLighter'></button> <button type='button' class='_ad_v ms-font-weight-regular ms-font-color-neutralLighter'></button> <button type='button' class='_ad_v ms-font-weight-regular ms-font-m ms-font-color-neutralLighter'></button> </div> <div class='_ad_G'> <button type='button' class='_ad_u ms-bg-color-neutralSecondary-hover'></button> <button type='button' class='_ad_u ms-bg-color-neutralSecondary-hover'></button> </div> </div> <div class='_ad_A ms-bg-color-neutralPrimary'> <button autoid=\"_ad_0\" type='button' class='_ad_I _ad_C _ad_D ms-font-color-white'></button> <button autoid=\"_ad_1\" type='button' class='_ad_I _ad_C _ad_E ms-font-color-white'></button> <div class='_ad_n'> <button type='button' class='_ad_z _ad_t ms-font-m ms-font-weight-regular ms-font-color-white'></button> <div class='_ad_o'> <div class='_ad_s ms-font-color-white'></div> <div class='_ad_p'> <img autoid=\"_ad_2\"/> <div class='_ad_q'> <span class='ms-font-size-m ms-font-weight-regular ms-font-color-neutralTertiary'></span> <span class='ms-font-size-m ms-font-weight-regular ms-font-color-neutralSecondaryAlt'></span> </div> </div> </div> <div></div> </div> </div> </div> <div class='hidden'></div> </div><div> <button type='button' class='_ad_R _ad_Q ms-font-weight-regular ms-font-m'></button> </div><div> <div></div> </div><div> <div class='_ad_J'> <div class='_ad_L ms-bg-color-themeLighterAlt'> <div class='_ad_O'> <button type='button' class='ms-bg-color-themeLight-hover _ad_S'></button> <button type='button' class='_ad_S ms-bg-color-themeLight-hover'></button> </div> <div class='_ad_N'> <a></a> <button type='button' class='_ad_R ms-font-weight-regular ms-font-color-neutralTertiaryAlt'></button> <button type='button' class='_ad_R ms-font-weight-regular ms-font-m'></button> </div> </div> <div> <div class='_ad_K'></div> </div> </div>  </div><div> <div class='_ad_T'></div> </div><div> <div></div> <div></div> </div><div> <button type='button' class='_ad_01 ms-font-weight-regular ms-font-m'></button> </div><div> <button type='button' class='_ad_11 ms-font-color-white ms-font-m ms-bg-color-themeSecondary'></button> <div class='_ad_21'> <a></a> <button type='button' class='_ad_01 ms-font-weight-regular ms-font-color-neutralTertiaryAlt'></button> <button type='button' class='_ad_01 ms-font-weight-regular ms-font-m'></button> <button type='button' class='_ad_Z ms-bg-color-themeLight-hover'></button> <button type='button' class='_ad_Z ms-bg-color-themeLight-hover'></button> </div> </div><div> <button type='button' class='_ad_01 ms-font-weight-regular ms-font-color-neutralLighter'></button> </div><div> <button type='button' class='_ad_11 ms-font-color-white ms-font-m ms-bg-color-themeSecondary'></button> <div class='_ad_21'> <a></a> <button type='button' class='_ad_01 ms-font-weight-regular ms-font-color-neutralSecondary'></button> <button type='button' class='_ad_01 ms-font-weight-regular ms-font-color-neutralLighter'></button> <button type='button' class='_ad_Z ms-bg-color-neutralSecondary-hover'></button> <button type='button' class='_ad_Z ms-bg-color-neutralSecondary-hover'></button> </div> </div><div> <div class='_ad_U'>  <div> <div class='_ad_U'> <div class='ms-bg-color-themeLighterAlt _ad_Y'> <button type='button' class='_ad_Z ms-bg-color-themeLight-hover'></button> <button type='button' class='_ad_01 ms-font-weight-regular ms-font-m'></button> </div> <div class='ms-bg-color-neutralDark _ad_Y'> <button type='button' class='_ad_Z ms-bg-color-neutralSecondary-hover'></button> <button type='button' class='_ad_01 ms-font-weight-regular ms-font-color-neutralLighter'></button> </div> <div class='_ad_V'></div> </div> </div>  <div> <div></div> <div></div> <div></div> <div></div> <div></div> <div></div> <div class='_ad_U'> <div class='ms-bg-color-themeLighterAlt _ad_W'></div> <div class='ms-bg-color-neutralDark _ad_W'></div> <div></div> </div> </div> </div> </div><div> <div> <div class='_ad_41'></div> <div></div> <div></div> <div></div> <div></div> <div></div> <div></div> </div> </div><div> <div class='_ad_71'></div> </div><div> <div class='_ad_51'> <div> <div></div> <div></div> </div> <div> <div class='_ad_61'></div> <div></div> <div></div> <div></div> <div></div> <div></div> <div></div> <div></div> </div> </div> </div><div> <button type='button' class='_ad_d1 ms-font-weight-regular ms-font-color-neutralLighter'></button> </div><div> <div class='_ad_91'> <div class='_ad_b1 ms-bg-color-neutralDark'> <div class='_ad_f1'> <a></a> <button type='button' class='_ad_d1 ms-font-weight-regular ms-font-color-neutralSecondary'></button> <button type='button' class='_ad_d1 ms-font-weight-regular ms-font-m ms-font-color-neutralLighter'></button> </div> <div class='_ad_g1'> <button type='button' class='_ad_e1 ms-bg-color-neutralSecondary-hover'></button> <button type='button' class='_ad_e1 ms-bg-color-neutralSecondary-hover'></button> </div> </div> <div class='ms-bg-color-neutralPrimary'> <audio class='_ad_a1'></audio> </div> </div> </div><div> <button type='button' class='_ad_k1 ms-font-weight-regular ms-font-m'></button> </div><div> <div class='_ad_m1'> <a></a> <button type='button' class='_ad_k1 ms-font-weight-regular ms-font-color-neutralTertiaryAlt'></button> <button type='button' class='_ad_k1 ms-font-weight-regular ms-font-m'></button> </div> <div class='_ad_n1'> <button type='button' class='ms-bg-color-themeLight-hover _ad_l1'></button> <button type='button' class='_ad_l1 ms-bg-color-themeLight-hover'></button> </div> </div><div> <div></div> <div class='_ad_p1'> <pre class='_ad_q1'></pre> </div> </div><div> <div class='_ad_i1'> <div class='_ad_j1 ms-bg-color-themeLighterAlt'></div> <div></div> </div> </div>";_j.i.a().appendChild(n);return n};_ad.a.bs=function(n){return n.i};_ad.a.bU=function(n){return n.r()};_ad.a.bX=function(n){return n.n()};_ad.a.ca=function(n){return n.j};_ad.a.bY=function(n){return!n.m};_ad.a.bW=function(n){return n.s()};_ad.a.y=function(n){return n.g};_ad.a.F=function(n){return n.B()};_ad.a.l=function(n){return n.a};_ad.a.p=function(n){return n.q()};_ad.a.t=function(n){return n.p};_ad.a.E=function(n){return n.A()};_ad.a.G=function(n){return n.s};_ad.a.D=function(n){return n.g};_ad.a.C=function(n){return n.m};_ad.a.bV=function(n){return n.b};_ad.a.bZ=function(n){return n.t()};_ad.a.cA=function(n){return n.f};_ad.a.ce=function(n){return n.u};_ad.a.cf=function(n){return n.L()};_ad.a.bu=function(n){return n.n};_ad.a.cb=function(n){return n.q};_ad.a.z=function(n){return n.o};_ad.a.cd=function(n){return n.c};_ad.a.cc=function(n){return n.K()};_ad.a.bt=function(n){return n.m};_ad.a.bm=function(n){return n.u()};_ad.a.cj=function(n){return n.b()};_ad.a.ci=function(n){return n.bb()};_ad.a.ch=function(n){return n.bm()};_ad.a.ck=function(n){return n.q};_ad.a.bK=function(n){return n.g};_ad.a.cC=function(n){return n.o};_ad.a.cn=function(n){return n.bo()};_ad.a.cm=function(n){return n.N};_ad.a.A=function(n){return n.d};_ad.a.cq=function(n){return n.w};_ad.a.bM=function(n){return _ad.o.isInstanceOfType(n)?n.r:null};_ad.a.cp=function(n){return n.v};_ad.a.bL=function(n){return _ad.o.isInstanceOfType(n)?n.q:null};_ad.a.cB=function(n){return n.m};_ad.a.cl=function(n){return n.H};_ad.a.bv=function(n){return n.p};_ad.a.bw=function(n){return n.j};_ad.a.cg=function(n){return n.z};_ad.a.co=function(n){return n.i};_ad.a.cr=function(n){return n.J};_ad.a.ct=function(n){return n.a};_ad.a.m=function(n){return n.b()};_ad.a.B=function(n){return n.l};_ad.a.cs=function(n){return n.t()};_ad.a.bx=function(n){return n.c};_ad.a.cu=function(n){return n.b};_ad.a.bi=function(n){return n.i};_ad.a.bO=function(n){return n.g()};_ad.a.bG=function(n){return n.cd()};_ad.a.R=function(n){return n.q};_ad.a.cE=function(n){return n.v()};_ad.a.bH=function(n){return n.u};_ad.a.W=function(n){return n.cc()};_ad.a.bC=function(n){return n.ca};_ad.a.bA=function(n){return n.bY};_ad.a.bB=function(n){return n.bZ};_ad.a.bz=function(n){return n.eu()};_ad.a.T=function(n){return n.J};_ad.a.j=function(n){return n.j};_ad.a.S=function(n){return n.v};_ad.a.cv=function(n){return n.w()};_ad.a.V=function(n){return n.ck};_ad.a.bE=function(n){return n.dO()};_ad.a.bD=function(n){return n.cW};_ad.a.bF=function(n){return n.ci};_ad.a.by=function(n){return n.c};_ad.a.bf=function(n){return n.L};_ad.a.bg=function(n){return n.C};_ad.a.bc=function(n){return n.s};_ad.a.bk=function(n){return n.s};_ad.a.br=function(n){return n.X};_ad.a.U=function(n){return n.P};_ad.a.bh=function(n){return n.M};_ad.a.bj=function(n){return n.R};_ad.a.be=function(n){return n.Z};_ad.a.cx=function(n){return n.h()};_ad.a.bI=function(n){return n.b};_ad.a.H=function(n){return n.e};_ad.a.cw=function(n){return n.a};_ad.a.cy=function(n){return n.q()};_ad.a.bJ=function(n){return n.c};_ad.a.I=function(n){return n.d};_ad.a.X=function(n){return n.g};_ad.a.cz=function(n){return n.a};_ad.a.k=function(n,t){n.k(t)};_ad.a.d=function(n,t){n.bj(t)};_ad.a.c=function(n,t){n.l(t)};_ad.a.v=function(n,t){n.b(t)};_ad.a.b=function(n,t){n.K(t)};_ad.a.s=function(n,t){n.ce(t)};_ad.a.q=function(n,t){n.bY(t)};_ad.a.u=function(n,t){n.d(t)};_ad.a.r=function(n,t){n.p(t)};_ad.a.f=function(n,t){n.T(t)};_ad.a.i=function(n,t){n.m(t)};_ad.a.n=function(n,t){n.E(t)};_ad.a.o=function(n,t){n.Q(t)};_ad.a.bq=function(n,t){n.a(t)};_ad.a.Q=function(n,t){n.a(t)};_ad.a.g=function(n,t){n.ba(t)};_ad.a.ba=function(n,t){n.b(t)};_ad.a.Z=function(n,t){n.d(t)};_ad.a.bp=function(n,t){n.a(t)};_ad.a.bn=function(n,t){n.c(t)};_ad.a.bT=function(n,t){n.t(t)};_ad.a.x=function(n,t){n.b(t)};_ad.a.w=function(n,t){n.c(t)};_ad.a.bb=function(n,t){n.bT(t)};_ad.a.bN=function(n,t){n.j(t)};_ad.a.bd=function(n,t){n.bf(t)};_ad.a.bl=function(n,t){n.cm(t)};_ad.a.cD=function(n,t){n.cn(t)};_ad.a.bo=function(n,t){n.l=t};_ad.a.h=function(){_ad.a.J||(_ad.a.J=new _fc.k);return _ad.a.J};_ad.a.bR=function(){_ad.a.O||(_ad.a.O=new _b.ba);return _ad.a.O};_ad.a.bQ=function(){_ad.a.N||(_ad.a.N=new _at.bQ);return _ad.a.N};_ad.a.P=function(){_ad.a.K||(_ad.a.K=new _fc.q);return _ad.a.K};_ad.a.Y=function(){_ad.a.M||(_ad.a.M=new _fc.l);return _ad.a.M};_ad.a.bP=function(){_ad.a.L||(_ad.a.L=new _fc.t);return _ad.a.L};_ad.a._I=function(){var n="DocumentPreview._tid1._tid2";new _j.d(n,function(){_ad.a.a[n]===undefined&&(_ad.a.a[n]=[[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.Q],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.e()]]]);var t=_ad.a.e.childNodes[0].cloneNode(!0);var i=new _fc.b(t.children[0]);i.c("ms-font-color-neutralDark ms-bg-color-themeLight");return new _j.a(t,[i])},"",_ad.w,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_ad.a.a);var t="DocumentPreview._tid1._tid3";new _j.d(t,function(){_ad.a.a[t]===undefined&&(_ad.a.a[t]=[[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.x()],[-1,0,["PreviewInNewTabText"],[_ad.a.bs],null,"Text",null,_ad.a.k,1,null,null,null],[-1,0,["PreviewInNewTabText"],[_ad.a.bs],null,"Title",null,_ad.a.d,1,null,null,null]]]);var n=_ad.a.e.childNodes[0].cloneNode(!0);var i=new _fc.b(n.children[0]);i.c("ms-font-color-neutralDark ms-bg-color-themeLight");return new _j.a(n,[i])},"",_ad.w,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_ad.a.a);var i="DocumentPreview._tid1";new _j.d(i,function(){_ad.a.a[i]===undefined&&(_ad.a.a[i]=[[[-1,0,["DownloadUrlWithoutPreview"],[_ad.a.bU],null,"Href",null,_ad.a.v,1,null,null,null],[-1,0,["IsDownloadHidden"],[_ad.a.bX],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,0,["PreviewInNewTabUrl"],[_ad.a.ca],null,"Href",null,_ad.a.v,1,null,null,null],[-1,0,["IsPreviewInNewTabHidden"],[_ad.a.bY],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.G],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.f()],[-1,0,["IsDownloadDisabledHidden"],[_ad.a.bW],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,4,null,null,null,"UncheckedText",null,_ad.a.s,0,null,null,null,_ads.B.s],[-1,4,null,null,null,"CheckedText",null,_ad.a.q,0,null,null,null,_ads.B.j],[-1,0,["LayoutStrategy","HideShowHideEmailButtonInAttachmentSideOfLightbox"],[_ad.a.y,_ad.a.F],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad.a.y,_ad.a.l],_ad.a.u,"IsChecked",_ad.a.p,_ad.a.r,2,null,null,!1],[-1,0,["LayoutStrategy","HideShowEmailCommand"],[_ad.a.y,_ad.a.t],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,5,["LayoutStrategy","ShowReadingPane"],[_ad.a.y,_ad.a.l],null,"_ad_8",null,null,0,_ad.a.h(),null,null]],[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_u.P.x],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.a()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.b()],[-1,0,["LayoutStrategy","HidePopoutButtonInAttachmentSideOfLightbox"],[_ad.a.y,_ad.a.E],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","PopOutCommand"],[_ad.a.y,_ad.a.G],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.c()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.d()],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.E],[-1,0,["LayoutStrategy","HideCloseButton"],[_ad.a.y,_ad.a.D],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ClosePreviewCommand"],[_ad.a.y,_ad.a.C],null,"ClickCommand",null,_ad.a.f,1,null,null,null]]]);var n=_ad.a.e.childNodes[1].cloneNode(!0);var f=new _fc.b(_j.a.a(n,[1,1]));var e=new _fc.b(_j.a.a(n,[1,0]));var o=new _j.i(n.children[1]);var r=new _fc.j(_j.a.a(n,[0,3]));r.c("ms-font-color-neutralDark ms-bg-color-themeLight");var s=new _fc.b(_j.a.a(n,[0,2]));var t=new _fc.e(_j.a.a(n,[0,1]));t.a("_blank");t.y("DocumentPreview._tid1._tid3");var u=new _fc.e(_j.a.a(n,[0,0]));u.y("DocumentPreview._tid1._tid2");return new _j.a(n,[u,t,s,r,o,e,f])},"",_ad.w,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var r="DocumentPreview";new _j.d(r,function(){_ad.a.a[r]===undefined&&(_ad.a.a[r]=[null,[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,52],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.D]],null,[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.M],[-1,0,["IsDocumentIFrameable"],[_ad.a.bV],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0],[-1,0,["PreviewDownloadUrlForIframe"],[_ad.a.bZ],null,"Source",null,_ad.a.bq,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_ad.a.Q,0,null,null,null,_ads.B.X],[-1,1,["ShowErrorMessageLabel"],[_ad.a.cA],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]]]);var t=_ad.a.e.childNodes[2].cloneNode(!0);var f=new _fc.a(_j.a.a(t,[0,1,1]));var e=new _b.A(_j.a.a(t,[0,1,0]));var i=new _j.i(_j.a.a(t,[0,1]));i.eI(_fce.c.a,4);i.z.parentNode.removeChild(i.z);var n=new _j.c(_j.a.a(t,[0,0]));n.eI(_fce.c.a,0);n.eI(_fce.c.b,40);n.y("DocumentPreview._tid1");n.z.parentNode.removeChild(n.z);var u=new _fce.c(t.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));u.b(2);u.a.a(n);u.a.a(i);return new _j.a(t,[u,n,i,e,f]).l({ElementContainingEmbed:i,IFrameDocumentPreview:e,MessageLabel:f})},"",_ad.w,_ad.y,function(n){return new _ad.y(n)},!1,!1,!1,0,_ad.a.a);var u="IcsPreview._tid4._tid5";new _j.d(u,function(){_ad.a.a[u]===undefined&&(_ad.a.a[u]=[[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.Q],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.e()],[-1,0,["DownloadCommand"],[_ad.a.ce],null,"ClickCommand",null,_ad.a.f,1,null,null,null]]]);var n=_ad.a.e.childNodes[3].cloneNode(!0);var t=new _fc.b(n.children[0]);t.c("ms-font-color-neutralDark ms-bg-color-themeLight");return new _j.a(n,[t])},"",_ad.m,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_ad.a.a);var f="IcsPreview._tid4";new _j.d(f,function(){_ad.a.a[f]===undefined&&(_ad.a.a[f]=[[[-1,0,["DownloadUrl"],[_ad.a.cf],null,"Href",null,_ad.a.v,1,null,null,null],[-1,0,["IsDownloadDisabled"],[_ad.a.bu],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.G],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.f()],[-1,0,["IsDownloadDisabled"],[_ad.a.bu],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_nbs.a.JQ],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.y()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.z()],[-1,0,["AddToCalendarCommand"],[_ad.a.cb],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"UncheckedText",null,_ad.a.s,0,null,null,null,_ads.B.s],[-1,4,null,null,null,"CheckedText",null,_ad.a.q,0,null,null,null,_ads.B.j],[-1,0,["LayoutStrategy","HideShowHideEmailButtonInAttachmentSideOfLightbox"],[_ad.a.z,_ad.a.F],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad.a.z,_ad.a.l],_ad.a.u,"IsChecked",_ad.a.p,_ad.a.r,2,null,null,!1],[-1,0,["LayoutStrategy","HideShowEmailCommand"],[_ad.a.z,_ad.a.t],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,5,["LayoutStrategy","ShowReadingPane"],[_ad.a.z,_ad.a.l],null,"_ad_f",null,null,0,_ad.a.h(),null,null]],[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_u.P.x],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.a()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.b()],[-1,0,["LayoutStrategy","HidePopoutButtonInAttachmentSideOfLightbox"],[_ad.a.z,_ad.a.E],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","PopOutCommand"],[_ad.a.z,_ad.a.G],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.c()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.d()],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.E],[-1,0,["LayoutStrategy","HideCloseButton"],[_ad.a.z,_ad.a.D],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ClosePreviewCommand"],[_ad.a.z,_ad.a.C],null,"ClickCommand",null,_ad.a.f,1,null,null,null]]]);var n=_ad.a.e.childNodes[4].cloneNode(!0);var u=new _fc.b(_j.a.a(n,[1,1]));var e=new _fc.b(_j.a.a(n,[1,0]));var o=new _j.i(n.children[1]);var t=new _fc.j(_j.a.a(n,[0,3]));t.c("ms-font-color-neutralDark ms-bg-color-themeLight");var i=new _fc.b(_j.a.a(n,[0,2]));i.c("ms-font-color-neutralDark ms-bg-color-themeLight");var s=new _fc.b(_j.a.a(n,[0,1]));var r=new _fc.e(_j.a.a(n,[0,0]));r.y("IcsPreview._tid4._tid5");return new _j.a(n,[r,s,i,t,o,e,u])},"",_ad.m,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var e="IcsPreview";new _j.d(e,function(){_ad.a.a[e]===undefined&&(_ad.a.a[e]=[null,[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,52],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.D]],[[-1,0,["CalendarItemDetailsViewModel"],[_ad.a.cd],null,"DataContext",null,_ad.a.g,1,null,null,null]],[[-1,4,null,null,null,"SpinnerSize",null,_ad.a.ba,0,null,null,0,1],[-1,0,["AddToCalendarCommandText"],[_ad.a.cc],null,"BusyText",null,_ad.a.Z,1,null,null,null],[-1,0,["IsActionExecuting"],[_ad.a.bt],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],[[-1,0,["IsActionExecuting"],[_ad.a.bt],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]]]);var t=_ad.a.e.childNodes[5].cloneNode(!0);var f=new _j.c(_j.a.a(t,[0,3]));f.z.parentNode.removeChild(f.z);var u=new _fce.h(_j.a.a(t,[0,2]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));u.a=0;u.z.parentNode.removeChild(u.z);var i=new _j.c(_j.a.a(t,[0,1]));i.y("CalendarItemDetailsUnifiedView");i.L(!0);i.z.parentNode.removeChild(i.z);var n=new _j.c(_j.a.a(t,[0,0]));n.eI(_fce.c.a,0);n.eI(_fce.c.b,40);n.y("IcsPreview._tid4");n.z.parentNode.removeChild(n.z);var r=new _fce.c(t.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));r.b(2);r.a.a(n);r.a.a(i);r.a.a(u);r.a.a(f);return new _j.a(t,[r,n,i,u,f])},"",_ad.m,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_ad.a.a);var o="ImagePreviewLightBox._tid6";new _j.d(o,function(){_ad.a.a[o]===undefined&&(_ad.a.a[o]=[[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.Q],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.k()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.m()]]]);var n=_ad.a.e.childNodes[6].cloneNode(!0);var t=new _fc.b(n.children[0]);t.c("ms-font-color-white ms-bg-color-neutralSecondary");return new _j.a(n,[t])},"",_ad.i,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_ad.a.a);var s="ImagePreviewLightBox._tid7";new _j.d(s,function(){_ad.a.a[s]===undefined&&(_ad.a.a[s]=[[[-1,1,["CurrentImageId"],[_ad.a.bm],null,"Id",null,_ad.a.bp,1,null,null,null]]]);var n=_ad.a.e.childNodes[7].cloneNode(!0);var t=new _fc.d(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[t])},"",_ad.i,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_ad.a.a);var h="ImagePreviewLightBox._tid8";new _j.d(h,function(){_ad.a.a[h]===undefined&&(_ad.a.a[h]=[[[-1,1,["CurrentImageId"],[_ad.a.bm],null,"Id",null,_ad.a.bp,1,null,null,null]]]);var n=_ad.a.e.childNodes[7].cloneNode(!0);var t=new _fc.d(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));return new _j.a(n,[t])},"",_ad.i,_fc.b,function(n){return new _fc.b(n)},!1,!0,!1,0,_ad.a.a);var c="ImagePreviewLightBox._tid9";new _j.d(c,function(){_ad.a.a[c]===undefined&&(_ad.a.a[c]=[[[-1,0,["ImageStripViewModel"],[_ad.a.cj],null,"DataContext",null,_ad.a.g,1,null,null,null]]]);var n=_ad.a.e.childNodes[8].cloneNode(!0);var t=new _iav.b(n.children[0],_j.b.Instance.a(_b.a));return new _j.a(n,[t])},"",_ad.i,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var l="ImagePreviewLightBox";new _j.d(l,function(){_ad.a.a[l]===undefined&&(_ad.a.a[l]=[null,[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,52],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.D]],[[-1,0,["ImageDownloadUrl"],[_ad.a.ci],null,"Href",null,_ad.a.v,1,null,null,null],[-1,0,["HideDownloadButton"],[_ad.a.ch],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.G],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.l()],[-1,0,["IsDownloadDisabled"],[_ad.a.ck],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.f],[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.Y],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.r()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.s()],[-1,1,["HideFullscreenButton"],[_ad.a.bK],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,1,["FullscreenCommand"],[_ad.a.cC],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.S],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.q],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.t()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.u()],[-1,0,["ShouldHideOpenInOneDriveButton"],[_ad.a.cn],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["OpenInOneDriveCommand"],[_ad.a.cm],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"UncheckedText",null,_ad.a.s,0,null,null,null,_ads.B.s],[-1,4,null,null,null,"CheckedText",null,_ad.a.q,0,null,null,null,_ads.B.j],[-1,0,["LayoutStrategy","HideShowHideEmailButtonInAttachmentSideOfLightbox"],[_ad.a.A,_ad.a.F],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad.a.A,_ad.a.l],_ad.a.u,"IsChecked",_ad.a.p,_ad.a.r,2,null,null,!1],[-1,0,["LayoutStrategy","HideShowEmailCommand"],[_ad.a.A,_ad.a.t],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,5,["LayoutStrategy","ShowReadingPane"],[_ad.a.A,_ad.a.l],null,"_ad_H",null,null,0,_ad.a.h(),null,null]],[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_u.P.x],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.g()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.h()],[-1,0,["LayoutStrategy","HidePopoutButtonInAttachmentSideOfLightbox"],[_ad.a.A,_ad.a.E],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","PopOutCommand"],[_ad.a.A,_ad.a.G],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.i()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.j()],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.E],[-1,0,["LayoutStrategy","ClosePreviewCommand"],[_ad.a.A,_ad.a.C],null,"ClickCommand",null,_ad.a.f,1,null,null,null],[-1,0,["LayoutStrategy","HideCloseButton"],[_ad.a.A,_ad.a.D],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],null,[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_nbs.a.GF],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_fm.a.r],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_fm.a.r],[-1,1,["PreviewPrevImageAttachmentCommand"],[_ad.a.bM],null,"ClickCommand",null,_ad.a.f,1,null,null,null],[-1,0,["ShowPrevButton"],[_ad.a.cq],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_nbs.a.Z],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_fm.a.o],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_fm.a.o],[-1,1,["PreviewNextImageAttachmentCommand"],[_ad.a.bL],null,"ClickCommand",null,_ad.a.f,1,null,null,null],[-1,0,["ShowNextButton"],[_ad.a.cp],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],null,[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.F],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.o()],[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.F],[-1,1,["HideFullscreenButton"],[_ad.a.bK],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,1,["CloseFullscreenCommand"],[_ad.a.cB],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],null,[[-1,4,null,null,null,"BusyText",null,_ad.a.Z,0,null,null,null,_u.R.EF],[-1,0,["Loading"],[_ad.a.cl],null,"IsBusy",null,_ad.a.bn,1,null,null,!1]],[[-1,0,["CurrentImageAttachmentName"],[_ad.a.bv],null,"ImageName",null,_ad.a.bT,1,null,null,null]],[[-1,0,["CurrentImageAttachmentName"],[_ad.a.bv],null,"Text",null,_ad.a.Q,1,null,null,null]],[[-1,0,["IsReferenceAttachment"],[_ad.a.bw],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["CurrentImageAttachmentSize"],[_ad.a.cg],null,"Text",null,_ad.a.Q,1,new _j.r([_ad.a.bR(),_ad.a.bQ()],[null,null]),null,null]],[[-1,0,["ShowFilmstrip"],[_ad.a.co],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],[[-1,0,["WindowObjectViewModel"],[_ad.a.cr],null,"DataContext",null,_ad.a.g,1,null,null,null]]]);var n=_ad.a.e.childNodes[9].cloneNode(!0);var w=new _b.D(n.children[1]);var o=new _j.c(_j.a.a(n,[0,1,2,2]));o.y("ImagePreviewLightBox._tid9");var b=new _fc.a(_j.a.a(n,[0,1,2,1,1,1,1]));var k=new _fc.a(_j.a.a(n,[0,1,2,1,1,1,0]));var s=new _b.cd(_j.a.a(n,[0,1,2,1,1,0]));var h=new _fce.h(_j.a.a(n,[0,1,2,1,0]),_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a));var c=new _j.i(_j.a.a(n,[0,1,2,1]));var d=new _fc.b(_j.a.a(n,[0,1,2,0]));var a=new _j.i(_j.a.a(n,[0,1,2]));var r=new _fc.b(_j.a.a(n,[0,1,1]));r.eI(_fce.c.a,1);r.eI(_fce.c.b,70);r.y("ImagePreviewLightBox._tid8");var u=new _fc.b(_j.a.a(n,[0,1,0]));u.eI(_fce.c.a,3);u.eI(_fce.c.b,70);u.y("ImagePreviewLightBox._tid7");var t=new _j.i(_j.a.a(n,[0,1]));t.eI(_fce.c.a,4);t.z.parentNode.removeChild(t.z);var g=new _fc.b(_j.a.a(n,[0,0,1,1]));var nt=new _fc.b(_j.a.a(n,[0,0,1,0]));var tt=new _j.i(_j.a.a(n,[0,0,1]));var v=new _fc.j(_j.a.a(n,[0,0,0,4]));v.c("ms-font-color-white ms-bg-color-neutralSecondary");var y=new _fc.b(_j.a.a(n,[0,0,0,3]));y.c("ms-font-color-white ms-bg-color-neutralSecondary");var p=new _fc.b(_j.a.a(n,[0,0,0,2]));p.c("ms-font-color-white ms-bg-color-neutralSecondary");var it=new _fc.b(_j.a.a(n,[0,0,0,1]));var e=new _fc.e(_j.a.a(n,[0,0,0,0]));e.a("_blank");e.y("ImagePreviewLightBox._tid6");var i=new _j.i(_j.a.a(n,[0,0]));i.eI(_fce.c.a,0);i.eI(_fce.c.b,40);i.z.parentNode.removeChild(i.z);var f=new _fce.c(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));f.b(2);f.a.a(i);f.a.a(t);return new _j.a(n,[f,i,e,it,p,y,v,tt,nt,g,t,u,r,a,d,c,h,s,k,b,o,w]).l({FullscreenContainer:t,LeftArrow:u,RightArrow:r,ImagePanel:a,ImageContainer:c,loadingIcon:h,ImageAttachment:s})},"",_ad.i,_ad.o,function(n){return new _ad.o(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(_b.a),_j.b.Instance.a(_j.j))},!1,!1,!1,0,_ad.a.a);var a="ItemAttachmentPreview._tidb";new _j.d(a,function(){_ad.a.a[a]===undefined&&(_ad.a.a[a]=[[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.Q],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.e()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.n()]]]);var n=_ad.a.e.childNodes[10].cloneNode(!0);var t=new _fc.b(n.children[0]);t.c("ms-font-color-neutralDark ms-bg-color-themeLight");return new _j.a(n,[t])},"",_ad.s,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_ad.a.a);var v="ItemAttachmentPreview.Touch";new _j.d(v,function(){_ad.a.a[v]===undefined&&(_ad.a.a[v]=[[[-1,0,["ItemConductor"],[_ad.a.ct],null,"DataContext",null,_ad.a.g,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad.a.m],null,"ActiveNavigationStack",null,_ad.a.x,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad.a.m],null,"ActiveItems",null,_ad.a.w,1,null,null,null]]]);var n=_ad.a.e.childNodes[11].cloneNode(!0);var t=new _n.g(n.children[0],_j.b.Instance.a(_n.f),_j.b.Instance.a(_b.a));t.L(!0);return new _j.a(n,[t])},"",_ad.s,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_ad.a.a);var y="ItemAttachmentPreview";new _j.d(y,function(){_ad.a.a[y]===undefined&&(_ad.a.a[y]=[null,null,[[-1,5,["LayoutStrategy","ShowReadingPane"],[_ad.a.B,_ad.a.l],null,"_ad_P",null,null,0,_ad.a.h(),null,null]],[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_u.P.x],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.a()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.b()],[-1,0,["LayoutStrategy","HidePopoutButtonInAttachmentSideOfLightbox"],[_ad.a.B,_ad.a.E],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","PopOutCommand"],[_ad.a.B,_ad.a.G],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.c()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.d()],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.E],[-1,0,["LayoutStrategy","HideCloseButton"],[_ad.a.B,_ad.a.D],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ClosePreviewCommand"],[_ad.a.B,_ad.a.C],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,0,["ItemAttachmentDownloadUrl"],[_ad.a.cs],null,"Href",null,_ad.a.v,1,null,null,null],[-1,0,["IsDownloadDisabled"],[_ad.a.bx],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.G],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.f()],[-1,0,["IsDownloadDisabled"],[_ad.a.bx],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],[[-1,4,null,null,null,"UncheckedText",null,_ad.a.s,0,null,null,null,_ads.B.s],[-1,4,null,null,null,"CheckedText",null,_ad.a.q,0,null,null,null,_ads.B.j],[-1,0,["LayoutStrategy","HideShowHideEmailButtonInAttachmentSideOfLightbox"],[_ad.a.B,_ad.a.F],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad.a.B,_ad.a.l],_ad.a.u,"IsChecked",_ad.a.p,_ad.a.r,2,null,null,!1],[-1,0,["LayoutStrategy","HideShowEmailCommand"],[_ad.a.B,_ad.a.t],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],null,[[-1,0,["ItemReadingPaneViewModel"],[_ad.a.cu],null,"DataContext",null,_ad.a.g,1,null,null,null]]]);var n=_ad.a.e.childNodes[12].cloneNode(!0);var u=new _rp.k(_j.a.a(n,[0,1,0]),_j.b.Instance.a(_b.a),_j.b.Instance.a(_a.f),_j.b.Instance.a(_b.d));var i=new _j.i(_j.a.a(n,[0,1]));i.eI(_fce.c.a,4);i.z.parentNode.removeChild(i.z);var f=new _fc.j(_j.a.a(n,[0,0,1,2]));f.c("ms-font-color-neutralDark ms-bg-color-themeLight");var o=new _fc.b(_j.a.a(n,[0,0,1,1]));var e=new _fc.e(_j.a.a(n,[0,0,1,0]));e.y("ItemAttachmentPreview._tidb");var s=new _fc.b(_j.a.a(n,[0,0,0,1]));var h=new _fc.b(_j.a.a(n,[0,0,0,0]));var c=new _j.i(_j.a.a(n,[0,0,0]));var t=new _j.i(_j.a.a(n,[0,0]));t.eI(_fce.c.a,0);t.eI(_fce.c.b,40);t.z.parentNode.removeChild(t.z);var r=new _fce.c(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));r.b(2);r.a.a(t);r.a.a(i);return new _j.a(n,[r,t,c,h,s,e,o,f,i,u]).c(u)},"",_ad.s,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_ad.a.a);var p="LightBoxView._tidc._tidd._tide";new _j.d(p,function(){_ad.a.a[p]===undefined&&(_ad.a.a[p]=[[[-1,4,null,null,null,"TextSelectionType",null,_ad.a.bb,0,null,null,0,2],[-1,0,["ReadingPane","ReadingPaneConductor"],[_ad.a.bi,_ad.a.bO],null,"DataContext",null,_ad.a.g,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad.a.m],null,"ActiveNavigationStack",null,_ad.a.x,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad.a.m],null,"ActiveItems",null,_ad.a.w,1,null,null,null]]]);var n=_ad.a.e.childNodes[13].cloneNode(!0);var t=new _n.g(n.children[0],_j.b.Instance.a(_n.f),_j.b.Instance.a(_b.a));return new _j.a(n,[t]).c(t)},"",_ad.c,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var w="LightBoxView._tidc._tidd._tidf";new _j.d(w,function(){_ad.a.a[w]===undefined&&(_ad.a.a[w]=[[[-1,0,["SideConductor"],[_ad.a.bG],null,"DataContext",null,_ad.a.g,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad.a.m],null,"ActiveNavigationStack",null,_ad.a.x,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad.a.m],null,"ActiveItems",null,_ad.a.w,1,null,null,null]]]);var n=_ad.a.e.childNodes[13].cloneNode(!0);var t=new _n.g(n.children[0],_j.b.Instance.a(_n.f),_j.b.Instance.a(_b.a));return new _j.a(n,[t]).c(t)},"",_ad.c,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var b="LightBoxView._tidc._tidd";new _j.d(b,function(){_ad.a.a[b]===undefined&&(_ad.a.a[b]=[[[-1,0,["CollabStep"],[_ad.a.R],null,"IsHidden",null,_ad.a.b,1,_ad.a.P(),4,!0]],[[-1,0,["CollabStep"],[_ad.a.R],null,"IsHidden",null,_ad.a.b,1,new _j.r([_ad.a.P(),_ad.a.h()],[4,null]),null,!0]]]);var n=_ad.a.e.childNodes[14].cloneNode(!0);var t=new _j.c(n.children[1]);t.y("LightBoxView._tidc._tidd._tidf");var i=new _j.c(n.children[0]);i.y("LightBoxView._tidc._tidd._tide");return new _j.a(n,[i,t])},"",_ad.c,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var k="LightBoxView._tidc._tidg";new _j.d(k,function(){_ad.a.a[k]===undefined&&(_ad.a.a[k]=[[[-1,4,null,null,null,"TextSelectionType",null,_ad.a.bb,0,null,null,0,2],[-1,0,["ReadingPane","LightBoxReadingPaneConductor"],[_ad.a.bi,_ad.a.cE],null,"DataContext",null,_ad.a.g,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad.a.m],null,"ActiveNavigationStack",null,_ad.a.x,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad.a.m],null,"ActiveItems",null,_ad.a.w,1,null,null,null]]]);var n=_ad.a.e.childNodes[13].cloneNode(!0);var t=new _n.g(n.children[0],_j.b.Instance.a(_n.f),_j.b.Instance.a(_b.a));return new _j.a(n,[t]).c(t)},"",_ad.c,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var d="LightBoxView._tidc";new _j.d(d,function(){_ad.a.a[d]===undefined&&(_ad.a.a[d]=[[[-1,0,["UseNewLightBoxV3"],[_ad.a.bH],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,0,["UseNewLightBoxV3"],[_ad.a.bH],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]]]);var n=_ad.a.e.childNodes[14].cloneNode(!0);var t=new _j.c(n.children[1]);t.y("LightBoxView._tidc._tidg");var i=new _j.c(n.children[0]);i.y("LightBoxView._tidc._tidd");return new _j.a(n,[i,t])},"",_ad.c,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var g="LightBoxView._tidi._tidj";new _j.d(g,function(){_ad.a.a[g]===undefined&&(_ad.a.a[g]=[[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.e()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.n()],[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.Q]]]);var n=_ad.a.e.childNodes[15].cloneNode(!0);var t=new _fc.b(n.children[0]);t.c("ms-font-color-neutralDark ms-bg-color-themeLight");return new _j.a(n,[t])},"",_ad.c,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_ad.a.a);var nt="LightBoxView._tidi";new _j.d(nt,function(){_ad.a.a[nt]===undefined&&(_ad.a.a[nt]=[[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.v()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.w()],[-1,0,["ShowEditButton"],[_ad.a.W],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0],[-1,0,["EditCommand"],[_ad.a.bC],null,"ClickCommand",null,_ad.a.f,1,null,null,null],[-1,0,["EditButtonText"],[_ad.a.bA],null,"Text",null,_ad.a.k,1,null,null,null],[-1,0,["EditButtonTitle"],[_ad.a.bB],null,"Title",null,_ad.a.d,1,null,null,null]],[[-1,5,["ShowEditButton"],[_ad.a.W],null,"_ad_31",null,null,0,null,null,null]],[[-1,0,["DocumentDownloadUrl"],[_ad.a.bz],null,"Href",null,_ad.a.v,1,null,null,null],[-1,0,["IsDownloadDisabled"],[_ad.a.T],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.G],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.f()],[-1,0,["IsDownloadDisabled"],[_ad.a.T],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],[[-1,4,null,null,null,"UncheckedText",null,_ad.a.s,0,null,null,null,_ads.B.s],[-1,4,null,null,null,"CheckedText",null,_ad.a.q,0,null,null,null,_ads.B.j],[-1,0,["LayoutStrategy","HideShowHideEmailButtonInAttachmentSideOfLightbox"],[_ad.a.j,_ad.a.F],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad.a.j,_ad.a.l],_ad.a.u,"IsChecked",_ad.a.p,_ad.a.r,2,null,null,!1],[-1,0,["LayoutStrategy","HideShowEmailCommand"],[_ad.a.j,_ad.a.t],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.c()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.d()],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.E],[-1,0,["LayoutStrategy","ClosePreviewCommand"],[_ad.a.j,_ad.a.C],null,"ClickCommand",null,_ad.a.f,1,null,null,null],[-1,0,["LayoutStrategy","HideCloseButton"],[_ad.a.j,_ad.a.D],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_u.P.x],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.a()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.b()],[-1,0,["LayoutStrategy","HidePopoutButtonInAttachmentSideOfLightbox"],[_ad.a.j,_ad.a.E],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","PopOutCommand"],[_ad.a.j,_ad.a.G],null,"ClickCommand",null,_ad.a.f,1,null,null,null]]]);var n=_ad.a.e.childNodes[16].cloneNode(!0);var r=new _fc.b(_j.a.a(n,[1,4]));var u=new _fc.b(_j.a.a(n,[1,3]));var t=new _fc.j(_j.a.a(n,[1,2]));t.c("ms-font-color-neutralDark ms-bg-color-themeLight");var f=new _fc.b(_j.a.a(n,[1,1]));var i=new _fc.e(_j.a.a(n,[1,0]));i.y("LightBoxView._tidi._tidj");var e=new _j.i(n.children[1]);var o=new _fc.b(n.children[0]);return new _j.a(n,[o,e,i,f,t,u,r])},"",_ad.c,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var tt="LightBoxView._tidk._tidl";new _j.d(tt,function(){_ad.a.a[tt]===undefined&&(_ad.a.a[tt]=[[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.k()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.m()],[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.Q]]]);var n=_ad.a.e.childNodes[17].cloneNode(!0);var t=new _fc.b(n.children[0]);t.c("ms-font-color-white ms-bg-color-neutralSecondary");return new _j.a(n,[t])},"",_ad.c,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_ad.a.a);var it="LightBoxView._tidk";new _j.d(it,function(){_ad.a.a[it]===undefined&&(_ad.a.a[it]=[[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.p()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.q()],[-1,0,["ShowEditButton"],[_ad.a.W],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0],[-1,0,["EditCommand"],[_ad.a.bC],null,"ClickCommand",null,_ad.a.f,1,null,null,null],[-1,0,["EditButtonText"],[_ad.a.bA],null,"Text",null,_ad.a.k,1,null,null,null],[-1,0,["EditButtonTitle"],[_ad.a.bB],null,"Title",null,_ad.a.d,1,null,null,null]],[[-1,5,["ShowEditButton"],[_ad.a.W],null,"_ad_31",null,null,0,null,null,null]],[[-1,0,["DocumentDownloadUrl"],[_ad.a.bz],null,"Href",null,_ad.a.v,1,null,null,null],[-1,0,["IsDownloadDisabled"],[_ad.a.T],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.G],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.l()],[-1,0,["IsDownloadDisabled"],[_ad.a.T],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],[[-1,4,null,null,null,"UncheckedText",null,_ad.a.s,0,null,null,null,_ads.B.s],[-1,4,null,null,null,"CheckedText",null,_ad.a.q,0,null,null,null,_ads.B.j],[-1,0,["LayoutStrategy","HideShowHideEmailButtonInAttachmentSideOfLightbox"],[_ad.a.j,_ad.a.F],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad.a.j,_ad.a.l],_ad.a.u,"IsChecked",_ad.a.p,_ad.a.r,2,null,null,!1],[-1,0,["LayoutStrategy","HideShowEmailCommand"],[_ad.a.j,_ad.a.t],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.i()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.j()],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.E],[-1,0,["LayoutStrategy","ClosePreviewCommand"],[_ad.a.j,_ad.a.C],null,"ClickCommand",null,_ad.a.f,1,null,null,null],[-1,0,["LayoutStrategy","HideCloseButton"],[_ad.a.j,_ad.a.D],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_u.P.x],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.g()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.h()],[-1,0,["LayoutStrategy","HidePopoutButtonInAttachmentSideOfLightbox"],[_ad.a.j,_ad.a.E],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","PopOutCommand"],[_ad.a.j,_ad.a.G],null,"ClickCommand",null,_ad.a.f,1,null,null,null]]]);var n=_ad.a.e.childNodes[18].cloneNode(!0);var r=new _fc.b(_j.a.a(n,[1,4]));var u=new _fc.b(_j.a.a(n,[1,3]));var t=new _fc.j(_j.a.a(n,[1,2]));t.c("ms-font-color-white ms-bg-color-neutralSecondary");var f=new _fc.b(_j.a.a(n,[1,1]));var i=new _fc.e(_j.a.a(n,[1,0]));i.y("LightBoxView._tidk._tidl");var e=new _j.i(n.children[1]);var o=new _fc.b(n.children[0]);return new _j.a(n,[o,e,i,f,t,u,r])},"",_ad.c,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var rt="LightBoxView._tidm";new _j.d(rt,function(){_ad.a.a[rt]===undefined&&(_ad.a.a[rt]=[[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.I],[-1,0,["DocumentConductor"],[_ad.a.S],null,"DataContext",null,_ad.a.g,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad.a.m],null,"ActiveNavigationStack",null,_ad.a.x,1,null,null,null],[0,0,["ActiveNavigationStack"],[_ad.a.m],null,"ActiveItems",null,_ad.a.w,1,null,null,null]]]);var t=_ad.a.e.childNodes[11].cloneNode(!0);var n=new _n.g(t.children[0],_j.b.Instance.a(_n.f),_j.b.Instance.a(_b.a));n.L(!0);return new _j.a(t,[n]).c(n)},"",_ad.c,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var ut="LightBoxView";new _j.d(ut,function(){_ad.a.a[ut]===undefined&&(_ad.a.a[ut]=[null,[[-1,2,["LayoutStrategy","DocumentToolbarWidth"],[_ad.a.j,_ad.a.cv],null,_fce.c.b,null,null,1,null,null,null]],null,[[-1,0,["NeedHighContrastLightbox"],[_ad.a.V],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_u.P.x],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.a()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.b()],[-1,0,["ShouldHidePopoutButton"],[_ad.a.bE],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["PopoutCommand"],[_ad.a.bD],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"UncheckedText",null,_ad.a.s,0,null,null,null,_ads.B.s],[-1,4,null,null,null,"CheckedText",null,_ad.a.q,0,null,null,null,_ads.B.j],[-1,0,["ShouldHideShowHideEmailButton"],[_ad.a.bF],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad.a.j,_ad.a.l],_ad.a.u,"IsChecked",_ad.a.p,_ad.a.r,2,null,null,!1],[-1,0,["LayoutStrategy","HideShowEmailCommand"],[_ad.a.j,_ad.a.t],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,0,["NeedHighContrastLightbox"],[_ad.a.V],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_u.P.x],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.g()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.h()],[-1,0,["ShouldHidePopoutButton"],[_ad.a.bE],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["PopoutCommand"],[_ad.a.bD],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"UncheckedText",null,_ad.a.s,0,null,null,null,_ads.B.s],[-1,4,null,null,null,"CheckedText",null,_ad.a.q,0,null,null,null,_ads.B.j],[-1,0,["ShouldHideShowHideEmailButton"],[_ad.a.bF],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad.a.j,_ad.a.l],_ad.a.u,"IsChecked",_ad.a.p,_ad.a.r,2,null,null,!1],[-1,0,["LayoutStrategy","HideShowEmailCommand"],[_ad.a.j,_ad.a.t],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.l],[-1,2,["LayoutStrategy","ReadingPaneWidth"],[_ad.a.j,_ad.a.by],null,_fce.c.b,null,null,1,null,null,null],[-1,2,["LayoutStrategy","ShowReadingPane"],[_ad.a.j,_ad.a.l],null,_fce.c.c,null,null,1,null,null,null],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad.a.j,_ad.a.l],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],null,[[-1,0,["IcsPreviewViewModel"],[_ad.a.bf],null,"DataContext",null,_ad.a.g,1,null,null,null]],[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.P],[-1,0,["ImagePreviewViewModel"],[_ad.a.bg],null,"DataContext",null,_ad.a.g,1,null,null,null],[0,0,["ReadingPaneSize"],[_ad.a.bc],_ad.a.bd,"ReadingPaneSize",_ad.a.bk,_ad.a.bl,2,null,null,0],[0,0,["IsReferenceAttachment"],[_ad.a.bw],null,"ShouldShowURLInNewWindowOnError",null,_ad.a.cD,1,null,null,!1]],[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.K],[-1,0,["MediaPreviewViewModel"],[_ad.a.U],null,"DataContext",null,_ad.a.g,1,null,null,null]],[[-1,0,["ItemAttachmentPreviewViewModel"],[_ad.a.bh],null,"DataContext",null,_ad.a.g,1,null,null,null]],[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.I],[-1,0,["TextPreviewViewModel"],[_ad.a.bj],null,"DataContext",null,_ad.a.g,1,null,null,null]],[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.I],[-1,0,["DocumentPreviewViewModel"],[_ad.a.be],null,"DataContext",null,_ad.a.g,1,null,null,null]],[[-1,0,["DocumentConductor"],[_ad.a.S],null,"IsHidden",null,_ad.a.b,1,_ad.a.Y(),null,!0]],[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,52],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.D],[-1,0,["NeedHighContrastLightbox"],[_ad.a.V],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,5,["LayoutStrategy","ShowReadingPane"],[_ad.a.j,_ad.a.l],null,"_ad_X",null,null,0,_ad.a.h(),null,null]],[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,52],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.D],[-1,0,["NeedHighContrastLightbox"],[_ad.a.V],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0],[-1,5,["LayoutStrategy","ShowReadingPane"],[_ad.a.j,_ad.a.l],null,"_ad_X",null,null,0,_ad.a.h(),null,null]],[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,48],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.I]]]);var n=_ad.a.e.childNodes[19].cloneNode(!0);var u=new _j.c(_j.a.a(n,[0,1,6,2]));u.eI(_fce.c.a,4);u.y("LightBoxView._tidm");u.z.parentNode.removeChild(u.z);var t=new _j.c(_j.a.a(n,[0,1,6,1]));t.eI(_fce.c.a,0);t.eI(_fce.c.b,40);t.y("LightBoxView._tidk");t.z.parentNode.removeChild(t.z);var i=new _j.c(_j.a.a(n,[0,1,6,0]));i.eI(_fce.c.a,0);i.eI(_fce.c.b,40);i.y("LightBoxView._tidi");i.z.parentNode.removeChild(i.z);var h=new _fce.c(_j.a.a(n,[0,1,6]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));h.b(2);var a=new _ad.y(_j.a.a(n,[0,1,5]));a.y("DocumentPreview");a.L(!0);var v=new _j.c(_j.a.a(n,[0,1,4]));v.y("TextPreview");v.L(!0);var y=new _j.c(_j.a.a(n,[0,1,3]));y.y("ItemAttachmentPreview");y.L(!0);var nt=new _ad.v(_j.a.a(n,[0,1,2]),_j.b.Instance.a(_j.j));nt.L(!0);var p=new _ad.o(_j.a.a(n,[0,1,1]),_j.b.Instance.a(_y.a),_j.b.Instance.a(_b.a),_j.b.Instance.a(_j.j));p.L(!0);var tt=new _fc.g;var w=new _fc.c;w.W(_j.f.a(["ContextParent","PreviewPrevImageAttachmentCommand"],[_ad.a.br,_ad.a.bM],null,"Command",null,_ad.a.bo,1));w.j("LEFTARROW");var b=new _fc.c;b.W(_j.f.a(["ContextParent","PreviewNextImageAttachmentCommand"],[_ad.a.br,_ad.a.bL],null,"Command",null,_ad.a.bo,1));b.j("RIGHTARROW");tt.a([w,b]);p.C([tt]);var k=new _j.c(_j.a.a(n,[0,1,0]));k.y("IcsPreview");k.L(!0);var f=new _j.i(_j.a.a(n,[0,1]));f.eI(_fce.c.a,4);f.z.parentNode.removeChild(f.z);var r=new _j.c(_j.a.a(n,[0,0,0,2]));r.eI(_fce.c.a,4);r.y("LightBoxView._tidc");r.z.parentNode.removeChild(r.z);var it=new _fc.j(_j.a.a(n,[0,0,0,1,1]));it.c("ms-font-color-white ms-bg-color-neutralSecondary");var ft=new _fc.b(_j.a.a(n,[0,0,0,1,0]));var e=new _j.i(_j.a.a(n,[0,0,0,1]));e.eI(_fce.c.a,0);e.eI(_fce.c.b,40);e.z.parentNode.removeChild(e.z);var rt=new _fc.j(_j.a.a(n,[0,0,0,0,1]));rt.c("ms-font-color-neutralDark ms-bg-color-themeLight");var et=new _fc.b(_j.a.a(n,[0,0,0,0,0]));var o=new _j.i(_j.a.a(n,[0,0,0,0]));o.eI(_fce.c.a,0);o.eI(_fce.c.b,40);o.z.parentNode.removeChild(o.z);var c=new _fce.c(_j.a.a(n,[0,0,0]),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));c.b(2);var l=new _j.i(_j.a.a(n,[0,0]));l.eI(_fce.c.a,1);l.z.parentNode.removeChild(l.z);var s=new _fce.c(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));s.b(2);var d=new _b.m(_j.b.Instance.a(_b.j),_j.b.Instance.a(_j.o));d.U(_j.f.b(402,null,null,null,"Priority",null,_ad.a.bN,0,null,null,0));d.i(!0);s.C([d]);var g=new _b.m(_j.b.Instance.a(_b.j),_j.b.Instance.a(_j.o));g.U(_j.f.b(401,null,null,null,"Priority",null,_ad.a.bN,0,null,null,0));g.i(!0);s.C([g]);s.a.a(l);c.a.a(o);c.a.a(e);c.a.a(r);s.a.a(f);h.a.a(i);h.a.a(t);h.a.a(u);return new _j.a(n,[s,l,c,o,et,rt,e,ft,it,r,f,k,p,nt,y,v,a,h,i,t,u]).l({readingPaneElement:r,attachmentViewElement:f}).c(a)},"",_ad.c,_ad.u,function(n){return new _ad.u(n,_j.b.Instance.a(_y.a),_j.b.Instance.a(_b.j),_j.b.Instance.a(_b.a))},!1,!1,!1,0,_ad.a.a);var ft="MediaPreview._tidp";new _j.d(ft,function(){_ad.a.a[ft]===undefined&&(_ad.a.a[ft]=[[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.Q],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.k()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.m()]]]);var n=_ad.a.e.childNodes[23].cloneNode(!0);var t=new _fc.b(n.children[0]);t.c("ms-font-color-white ms-bg-color-neutralSecondary");return new _j.a(n,[t])},"",_ad.J,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_ad.a.a);var et="MediaPreview";new _j.d(et,function(){_ad.a.a[et]===undefined&&(_ad.a.a[et]=[null,[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,52],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.D]],[[-1,0,["MediaUrlDownload"],[_ad.a.cx],null,"Href",null,_ad.a.v,1,null,null,null],[-1,0,["IsDownloadDisabled"],[_ad.a.bI],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.G],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.l()],[-1,0,["IsDownloadDisabled"],[_ad.a.bI],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],[[-1,4,null,null,null,"UncheckedText",null,_ad.a.s,0,null,null,null,_ads.B.s],[-1,4,null,null,null,"CheckedText",null,_ad.a.q,0,null,null,null,_ads.B.j],[-1,0,["LayoutStrategy","HideShowHideEmailButtonInAttachmentSideOfLightbox"],[_ad.a.H,_ad.a.F],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad.a.H,_ad.a.l],_ad.a.u,"IsChecked",_ad.a.p,_ad.a.r,2,null,null,!1],[-1,0,["LayoutStrategy","HideShowEmailCommand"],[_ad.a.H,_ad.a.t],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,5,["LayoutStrategy","ShowReadingPane"],[_ad.a.H,_ad.a.l],null,"_ad_h1",null,null,0,_ad.a.h(),null,null]],[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_u.P.x],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.g()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.h()],[-1,0,["LayoutStrategy","HidePopoutButtonInAttachmentSideOfLightbox"],[_ad.a.H,_ad.a.E],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","PopOutCommand"],[_ad.a.H,_ad.a.G],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.i()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.j()],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.E],[-1,0,["LayoutStrategy","ClosePreviewCommand"],[_ad.a.H,_ad.a.C],null,"ClickCommand",null,_ad.a.f,1,null,null,null],[-1,0,["LayoutStrategy","HideCloseButton"],[_ad.a.H,_ad.a.D],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],null,[[-1,0,["MediaUrl"],[_ad.a.cw],null,"Source",null,_ad.a.bq,1,null,null,null]]]);var n=_ad.a.e.childNodes[24].cloneNode(!0);var r=new _ad.ba(_j.a.a(n,[0,1,0]));r.d("controls");r.b("autoplay");var i=new _j.i(_j.a.a(n,[0,1]));i.eI(_fce.c.a,4);i.z.parentNode.removeChild(i.z);var o=new _fc.b(_j.a.a(n,[0,0,1,1]));var s=new _fc.b(_j.a.a(n,[0,0,1,0]));var h=new _j.i(_j.a.a(n,[0,0,1]));var f=new _fc.j(_j.a.a(n,[0,0,0,2]));f.c("ms-font-color-white ms-bg-color-neutralSecondary");var c=new _fc.b(_j.a.a(n,[0,0,0,1]));var e=new _fc.e(_j.a.a(n,[0,0,0,0]));e.y("MediaPreview._tidp");var t=new _j.i(_j.a.a(n,[0,0]));t.eI(_fce.c.a,0);t.eI(_fce.c.b,40);t.z.parentNode.removeChild(t.z);var u=new _fce.c(n.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));u.b(2);u.a.a(t);u.a.a(i);return new _j.a(n,[u,t,e,c,f,h,s,o,i,r]).l({MediaAttachment:r})},"",_ad.J,_ad.v,function(n){return new _ad.v(n,_j.b.Instance.a(_j.j))},!1,!1,!1,0,_ad.a.a);var ot="TextPreview._tidq._tidr";new _j.d(ot,function(){_ad.a.a[ot]===undefined&&(_ad.a.a[ot]=[[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.e()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.n()],[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.Q]]]);var n=_ad.a.e.childNodes[25].cloneNode(!0);var t=new _fc.b(n.children[0]);t.c("ms-font-color-neutralDark ms-bg-color-themeLight");return new _j.a(n,[t])},"",_ad.x,_fc.e,function(n){return new _fc.e(n)},!1,!0,!1,0,_ad.a.a);var st="TextPreview._tidq";new _j.d(st,function(){_ad.a.a[st]===undefined&&(_ad.a.a[st]=[[[-1,0,["TextDownloadUrl"],[_ad.a.cy],null,"Href",null,_ad.a.v,1,null,null,null],[-1,0,["IsDownloadDisabled"],[_ad.a.bJ],null,"IsHidden",null,_ad.a.b,1,null,null,!0]],[[-1,4,null,null,null,"Text",null,_ad.a.k,0,null,null,null,_ads.B.u],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.G],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.f()],[-1,0,["IsDownloadDisabled"],[_ad.a.bJ],null,"IsHidden",null,_ad.a.b,1,_ad.a.h(),null,!0]],[[-1,4,null,null,null,"UncheckedText",null,_ad.a.s,0,null,null,null,_ads.B.s],[-1,4,null,null,null,"CheckedText",null,_ad.a.q,0,null,null,null,_ads.B.j],[-1,0,["LayoutStrategy","HideShowHideEmailButtonInAttachmentSideOfLightbox"],[_ad.a.I,_ad.a.F],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ShowReadingPane"],[_ad.a.I,_ad.a.l],_ad.a.u,"IsChecked",_ad.a.p,_ad.a.r,2,null,null,!1],[-1,0,["LayoutStrategy","HideShowEmailCommand"],[_ad.a.I,_ad.a.t],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,5,["LayoutStrategy","ShowReadingPane"],[_ad.a.I,_ad.a.l],null,"_ad_o1",null,null,0,_ad.a.h(),null,null]],[[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_u.P.x],[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.a()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.b()],[-1,0,["LayoutStrategy","HidePopoutButtonInAttachmentSideOfLightbox"],[_ad.a.I,_ad.a.E],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","PopOutCommand"],[_ad.a.I,_ad.a.G],null,"ClickCommand",null,_ad.a.f,1,null,null,null]],[[-1,4,null,null,null,"ImageId",null,_ad.a.c,0,null,null,null,_ad.b.c()],[-1,4,null,null,null,"HoveredImageId",null,_ad.a.i,0,null,null,null,_ad.b.d()],[-1,4,null,null,null,"Title",null,_ad.a.d,0,null,null,null,_ads.B.E],[-1,0,["LayoutStrategy","HideCloseButton"],[_ad.a.I,_ad.a.D],null,"IsHidden",null,_ad.a.b,1,null,null,!0],[-1,0,["LayoutStrategy","ClosePreviewCommand"],[_ad.a.I,_ad.a.C],null,"ClickCommand",null,_ad.a.f,1,null,null,null]]]);var n=_ad.a.e.childNodes[26].cloneNode(!0);var r=new _fc.b(_j.a.a(n,[1,1]));var u=new _fc.b(_j.a.a(n,[1,0]));var f=new _j.i(n.children[1]);var t=new _fc.j(_j.a.a(n,[0,2]));t.c("ms-font-color-neutralDark ms-bg-color-themeLight");var e=new _fc.b(_j.a.a(n,[0,1]));var i=new _fc.e(_j.a.a(n,[0,0]));i.y("TextPreview._tidq._tidr");return new _j.a(n,[i,e,t,f,u,r])},"",_ad.x,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var ht="TextPreview._tids";new _j.d(ht,function(){_ad.a.a[ht]===undefined&&(_ad.a.a[ht]=[[[-1,4,null,null,null,"SpinnerSize",null,_ad.a.ba,0,null,null,0,1],[-1,0,["TextContent"],[_ad.a.X],null,"IsHidden",null,_ad.a.b,1,_ad.a.bP(),null,!0],[-1,0,["TextContent"],[_ad.a.X],null,"IsBusy",null,_ad.a.bn,1,_ad.a.Y(),null,!1]],[[-1,4,null,null,null,"TextSelectionType",null,_ad.a.bb,0,null,null,0,2],[-1,0,["TextContent"],[_ad.a.X],null,"IsHidden",null,_ad.a.b,1,_ad.a.Y(),null,!0]],[[-1,0,["TextContent"],[_ad.a.X],null,"Text",null,_ad.a.Q,1,null,null,null]]]);var n=_ad.a.e.childNodes[27].cloneNode(!0);var i=new _ad.bb(_j.a.a(n,[1,0]));var r=new _fce.g(n.children[1],_j.b.Instance.a(_j.p),_j.b.Instance.a(_ff.a),_j.b.Instance.a(_j.j));var t=new _b.t(n.children[0],_j.b.Instance.a(_j.o),_j.b.Instance.a(_ff.a));t.a=0;t.e(!0);return new _j.a(n,[t,r,i])},"",_ad.x,_j.c,function(n){return new _j.c(n)},!1,!0,!1,0,_ad.a.a);var ct="TextPreview";new _j.d(ct,function(){_ad.a.a[ct]===undefined&&(_ad.a.a[ct]=[null,[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,52],[-1,4,null,null,null,"AriaLabel",null,_ad.a.o,0,null,null,null,_ads.B.D]],[[-1,4,null,null,null,"AriaRole",null,_ad.a.n,0,null,null,0,48]]]);var i=_ad.a.e.childNodes[28].cloneNode(!0);var t=new _j.c(_j.a.a(i,[0,1]));t.eI(_fce.c.a,4);t.y("TextPreview._tids");t.z.parentNode.removeChild(t.z);var n=new _j.c(_j.a.a(i,[0,0]));n.eI(_fce.c.a,0);n.eI(_fce.c.b,40);n.y("TextPreview._tidq");n.z.parentNode.removeChild(n.z);var r=new _fce.c(i.children[0],_j.b.Instance.a(_ff.a),_j.b.Instance.a(_ff.b));r.b(2);r.a.a(n);r.a.a(t);return new _j.a(i,[r,n,t])},"",_ad.x,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_ad.a.a);var lt="TransitionView";new _j.d(lt,function(){_ad.a.a[lt]===undefined&&(_ad.a.a[lt]=[[[-1,4,null,null,null,"SpinnerSize",null,_ad.a.ba,0,null,null,0,1],[-1,0,["Message"],[_ad.a.cz],null,"BusyText",null,_ad.a.Z,1,null,null,null]]]);var t=_ad.a.e.childNodes[11].cloneNode(!0);var n=new _b.t(t.children[0],_j.b.Instance.a(_j.o),_j.b.Instance.a(_ff.a));n.a=0;n.D=!1;n.c(!0);return new _j.a(t,[n])},"",_ad.t,_j.c,function(n){return new _j.c(n)},!1,!1,!1,0,_ad.a.a)};CollabAttachmentPreviewComponent.registerClass("CollabAttachmentPreviewComponent",null,_a.jR,_j.ce);_ad.D.registerClass("_ad.D");_ad.Q.registerClass("_ad.Q",_h.fG);_ad.E.registerClass("_ad.E",_h.fG);_ad.P.registerClass("_ad.P",_h.fG);_ad.be.registerClass("_ad.be",null,_ad.bf);_ad.R.registerClass("_ad.R",_ad.be);_ad.S.registerClass("_ad.S",_ad.be);_ad.T.registerClass("_ad.T",_ad.be);_ad.w.registerClass("_ad.w",_a.bv);_ad.F.registerClass("_ad.F");_ad.g.registerClass("_ad.g",_a.ea);_ad.n.registerClass("_ad.n",_a.ea);_ad.l.registerClass("_ad.l",_a.ea);_ad.k.registerClass("_ad.k",_a.ea);_ad.j.registerClass("_ad.j",_a.ea);_ad.f.registerClass("_ad.f",_a.ea,_at.cd);_ad.e.registerClass("_ad.e",_ad.f,_at.bl,_at.cd);_ad.q.registerClass("_ad.q",_ad.f,_ad.N,_at.cd);_ad.A.registerClass("_ad.A",_ad.f,_ad.M,_at.cd);_ad.C.registerClass("_ad.C",_ad.f,_at.bm,_at.cd);_ad.d.registerClass("_ad.d",_ad.f,_at.bj,_at.cd);_ad.z.registerClass("_ad.z",_ad.f,_ad.L,_at.cd);_ad.h.registerClass("_ad.h",_ad.f,_at.q,_at.cd);_ad.B.registerClass("_ad.B",_ad.f,_ad.p,_at.cd);_ad.r.registerClass("_ad.r",_ad.f,_ad.O,_at.cd);_ad.s.registerClass("_ad.s",_a.bv);_ad.H.registerClass("_ad.H");_ad.V.registerClass("_ad.V");_ad.bg.registerClass("_ad.bg",_a.gb);_ad.X.registerClass("_ad.X",_ad.bg);_ad.c.registerClass("_ad.c",_y.lA,_bc.j,_bc.s,_bc.w,_a.kD,_j.bs,Sys.IDisposable,_at.ce,_y.cJ);_ad.J.registerClass("_ad.J",_a.bv);_ad.x.registerClass("_ad.x",_a.bv);_ad.t.registerClass("_ad.t",_a.bv);_ad.m.registerClass("_ad.m",_a.bv);_ad.i.registerClass("_ad.i",_a.bv);_ad.G.registerClass("_ad.G");_ad.I.registerClass("_ad.I",_ad.bg);_ad.Y.registerClass("_ad.Y",_ad.bg);_ad.bh.registerClass("_ad.bh",null,Sys.IDisposable);_ad.W.registerClass("_ad.W",_ad.bh);_ad.ba.registerClass("_ad.ba",_fc.y);_ad.y.registerClass("_ad.y",_j.c);_ad.o.registerClass("_ad.o",_j.c);_ad.u.registerClass("_ad.u",_j.c);_ad.v.registerClass("_ad.v",_j.c);_ad.bb.registerClass("_ad.bb",_fc.a);CollabAttachmentPreviewComponent.$$cctor();_ad.E.a="GetSharePointTextFileContentAction";_ad.K.a=_a.a.c;_ad.g.a=new _a.e("FromAutomaticPopout",Boolean,_ad.g);_ad.g.b=new _a.e("GroupSmtpAddress",String,_ad.g);_ad.g.c=new _a.e("LightBoxLeftPaneContextType",String,_ad.g);_ad.g.d=new _a.e("LightBoxLeftPaneContextValue",String,_ad.g);_ad.g.e=new _a.e("LightBoxRightPaneContextType",String,_ad.g);_ad.g.f=new _a.e("LightBoxRightPaneContextValue",String,_ad.g);_ad.n.a=new _a.e("AttachmentId",String,_ad.n);_ad.l.b=new _a.e("Url",String,_ad.l);_ad.l.a=new _a.e("PreviewType",_at.bP,_ad.l);_ad.k.b=new _a.e("Photos",_g.cI,_ad.k);_ad.k.a=new _a.e("IndexOfSelectedPhoto",Number,_ad.k);_ad.j.b=new _a.e("ReadingPaneType",_y.jB,_ad.j);_ad.j.a=new _a.e("ItemId",_g.e,_ad.j);_ad.f.b=new _a.e("AttachmentName",String,_ad.f);_ad.f.c=new _a.e("AttachmentSize",Number,_ad.f);_ad.f.a=new _a.e("AttachmentId",_g.bh,_ad.f);_ad.f.f=new _a.e("IsReferenceAttachment",Boolean,_ad.f);_ad.f.g=new _a.e("ProviderType",String,_ad.f);_ad.f.d=new _a.e("DefaultDownloadUrl",String,_ad.f);_ad.f.e=new _a.e("IsDownloadDisabled",Boolean,_ad.f);_ad.e.c=new _a.e("ImageThumbnailUrl",String,_ad.e);_ad.e.a=new _a.e("ImageDownloadUrl",String,_ad.e);_ad.e.b=new _a.e("ImagePreviewUrl",String,_ad.e);_ad.e.d=new _a.e("OpenInDataProviderUrl",String,_ad.e);_ad.e.e=new _a.e("Photos",_g.cI,_ad.e);_ad.e.f=new _a.e("ShouldCachePreviewImage",Boolean,_ad.e);_ad.q.a=new _a.e("MediaUrl",String,_ad.q);_ad.d.e=new _a.e("MimeType",String,_ad.d);_ad.d.a=new _a.e("DocumentPreviewDownloadUrl",String,_ad.d);_ad.d.d=new _a.e("IsDocumentIFramePreviewSupported",Boolean,_ad.d);_ad.d.c=new _a.e("DocumentPreviewInNewTabUrl",String,_ad.d);_ad.d.b=new _a.e("DocumentPreviewInNewTabText",String,_ad.d);_ad.d.f=new _a.e("ShouldShowDownloadOption",Boolean,_ad.d);_ad.d.g=new _a.e("ShouldShowPreviewInNewTabOption",Boolean,_ad.d);_ad.h.c=new _a.e("PreviewUrl",String,_ad.h);_ad.h.d=new _a.e("SharePointUrl",String,_ad.h);_ad.h.b=new _a.e("IsEditable",Boolean,_ad.h);_ad.h.a=new _a.e("GoToEditModeDirectly",Boolean,_ad.h);_ad.r.a=new _a.e("PreviewUrlProperty",String,_ad.r);_ad.s.a=_a.a.c;_ad.c.a=_a.a.c;_ad.c.b={};_ad.c.c={};_ad.c.d=0;_ad.m.a=_a.a.c;_ad.i.a=new _j.q;_ad.i.b=_a.a.c;_ad.a.e=_ad.a.bS();_ad.a.J=null;_ad.a.O=null;_ad.a.N=null;_ad.a.K=null;_ad.a.M=null;_ad.a.L=null;_ad.a.a={};_ad.a.$$cctor();
window.scriptsLoaded['microsoft.owa.attachments.collabattachmentpreview.js'] = 1; window.scriptProcessEnd = window.scriptProcessEnd || {}; window.scriptProcessEnd['microsoft.owa.attachments.collabattachmentpreview.js'] = (new Date()).getTime();
